{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.WIDGET_UI = exports.PROVIDERS_LIST_PLACEHOLDER = void 0;\nconst SCRIPT = `\nfunction assert(condition, error) {\n  if (!condition) {\n    if (!(error instanceof Error)) {\n      error = new Error('Auth Emulator Internal Error: ' + error);\n    }\n    // Show error with great visibility AND stops further user interactions.\n    document.body.textContent = error.stack || error.message;\n    document.body.style = 'color:red;white-space:pre';\n    throw error; // Halts current script and prints error to console.\n  }\n}\n\n// TODO: Support older browsers where URLSearchParams is not available.\nvar query = new URLSearchParams(location.search);\nvar internalError = query.get('error');\nassert(!internalError, internalError);\n\nvar apiKey = query.get('apiKey');\nvar appName = query.get('appName');\nvar authType = query.get('authType');\nvar providerId = query.get('providerId');\nvar redirectUrl = query.get('redirectUrl');\nvar scopes = query.get('scopes');\nvar eventId = query.get('eventId');\nvar storageKey = apiKey + ':' + appName;\n\nvar clientId = query.get('clientId');\nvar firebaseAppId = query.get('appId');\nvar apn = query.get('apn');\nvar ibi = query.get('ibi');\nvar appIdentifier = apn || ibi;\nassert(\n  appName || clientId || firebaseAppId || appIdentifier,\n  'Missing one of appName / clientId / appId / apn / ibi query params.'\n);\n\n// Warn the developer of a few flows only available in Auth Emulator.\nif ((providerId === 'facebook.com' && appIdentifier) || (providerId === 'apple.com' && ibi)) {\n  var providerName = (providerId === 'facebook.com') ? 'Facebook' : 'Apple';\n  var productionMethod = providerName + (apn ? ' Android SDK' : ' iOS SDK');\n  var warningEl = document.querySelector('.js-signin-warning');\n  warningEl.querySelector('.content').textContent =\n    'Sign-in with ' + providerName + ' via generic IDP is only supported in the Auth Emulator; ' +\n    'remember to switch to ' + productionMethod + ' for production Firebase projects.';\n  warningEl.style.display = 'flex';\n}\n\nfunction saveAuthEvent(authEvent) {\n  if (/popup/i.test(authType)) {\n    sendAuthEventViaIframeRelay(authEvent, function (err) {\n      assert(!err, err);\n    });\n  } else {\n    if (apn) {\n      redirectToAndroid(authEvent);\n    } else if (ibi) {\n      redirectToIos(authEvent);\n    } else if (redirectUrl) {\n      saveAuthEventToStorage(authEvent);\n      window.location = redirectUrl;\n    } else {\n      assert(false, 'This feature is not implemented in Auth Emulator yet. Please use signInWithCredential for now.');\n    }\n  }\n}\n\nfunction saveAuthEventToStorage(authEvent) {\n  sessionStorage['firebase:redirectEvent:' + storageKey] =\n    JSON.stringify(authEvent);\n}\n\nfunction sendAuthEventViaIframeRelay(authEvent, cb) {\n  var sent = false;\n  if (window.opener) {\n    for (var i = 0; i < window.opener.frames.length; i++) {\n      // Try/catch is necessary because without it, the code will crash the first time one of the frames does not have\n      // the same origin (from the iframeWin.location.search) and the loop will not reach the other frames.\n      try {\n        var iframeWin = window.opener.frames[i];\n        var query = new URLSearchParams(iframeWin.location.search);\n        if (query.get('apiKey') === apiKey && query.get('appName') === appName) {\n          iframeWin.postMessage({\n            data: {authEvent: authEvent, storageKey: storageKey},\n            eventId: Math.floor(Math.random() * Math.pow(10, 20)).toString(),\n            eventType: \"sendAuthEvent\",\n          }, '*');\n          sent = true;\n        }\n      } catch (e) {\n        // The frame does not have the same origin\n      }\n    }\n  }\n  if (!sent) {\n    return cb('No matching frame');\n  }\n  return cb();\n}\n\nfunction redirectToAndroid(authEvent) {\n  // This is shown when no app handles the link and displays an error.\n  var fallbackUrl = window.location.href + '&error=App+not+found+for+intent';\n\n  var link = 'intent://firebase.auth/#Intent;scheme=genericidp;' +\n      'package=' + apn + ';' +\n      'S.authType=' + authEvent.type + ';';\n  if (authEvent.eventId) {\n    link += 'S.eventId=' + authEvent.eventId + ';';\n  }\n  link += 'S.link=' + encodeURIComponent(authEvent.urlResponse) + ';';\n  link += 'B.encryptionEnabled=false;';\n  link += 'S.browser_fallback_url=' + encodeURIComponent(fallbackUrl) + ';';\n\n  link += 'end;';\n\n  window.location.replace(link);\n}\n\nfunction redirectToIos(authEvent) {\n  // This URL format is based on production widget and known to work with the\n  // iOS SDK. It does not matter that /__/auth/callback is not an actual page\n  // served by the Auth Emulator -- only the format and query params matter.\n  var url = window.location.protocol + '//' + window.location.host +\n      '/__/auth/callback?authType=' + encodeURIComponent(authEvent.type) +\n      '&link=' + encodeURIComponent(authEvent.urlResponse);\n  if (authEvent.eventId) {\n    url += '&eventId=' + authEvent.eventId;\n  }\n  var scheme;\n  if (clientId) {\n    scheme = clientId.split('.').reverse().join('.');\n  } else if (firebaseAppId) {\n    scheme = 'app-' + firebaseAppId.replace(/:/g, '-');\n  } else {\n    scheme = appIdentifier;\n  }\n  var deepLink = scheme + '://' +\n    (clientId || firebaseAppId ? 'firebaseauth' : 'google') + '/link';\n  deepLink += '?deep_link_id=' + encodeURIComponent(url);\n\n  window.location.replace(deepLink);\n}\n\n\n// DOM logic\n\nvar formattedProviderId = providerId[0].toUpperCase() + providerId.substring(1);\ndocument.querySelectorAll('.js-provider-id').forEach(function(e) {\n  e.textContent = formattedProviderId;\n});\n\nvar reuseAccountEls = document.querySelectorAll('.js-reuse-account');\nif (reuseAccountEls.length) {\n  [].forEach.call(reuseAccountEls, function (el) {\n    var urlEncodedIdToken = el.dataset.idToken;\n    el.addEventListener('click', function (e) {\n      e.preventDefault();\n      finishWithUser(urlEncodedIdToken);\n    });\n  });\n} else {\n  document.querySelector('.js-accounts-help-text').textContent = \"No \" + formattedProviderId + \" accounts exist in the Auth Emulator.\";\n}\n\nfunction finishWithUser(urlEncodedIdToken) {\n  // Use widget URL, but replace all query parameters (no apiKey etc.).\n  var url = window.location.href.split('?')[0];\n  // Avoid URLSearchParams for browser compatibility.\n  url += '?providerId=' + encodeURIComponent(providerId);\n  url += '&id_token=' + urlEncodedIdToken;\n  saveAuthEvent({\n    type: authType,\n    eventId: eventId,\n    urlResponse: url,\n    sessionId: \"ValueNotUsedByAuthEmulator\",\n    postBody: \"\",\n    tenantId: null,\n    error: null,\n  });\n}\n\ndocument.querySelector('.js-new-account').addEventListener('click', function (e) {\n  e.preventDefault();\n  toggleForm(true);\n});\n\nvar inputs = document.querySelectorAll('.mdc-text-field');\n// Set up styling and reactivity for inputs\ninputs.forEach(function (input) {\n  input.querySelector('input').addEventListener('input', function(e) {\n    var display = 'none';\n    if (!e.target.value) display = 'block';\n    input.querySelector('.custom-label').style.display = display;\n    validateForm();\n  });\n  window.mdc && mdc.textField.MDCTextField.attachTo(input);\n});\n\ndocument.getElementById('autogen-button').addEventListener('click', function() {\n  runAutogen();\n});\n\n// Handle form validation and submission\ndocument.getElementById('main-form').addEventListener('submit', function(e) {\n  e.preventDefault();\n  var valid = validateForm();\n  if (valid) {\n    var email = document.getElementById('email-input').value;\n    var displayName = document.getElementById('display-name-input').value;\n    var screenName = document.getElementById('screen-name-input').value;\n    var photoUrl = document.getElementById('profile-photo-input').value;\n    var claims = {};\n\n    if (email) claims.email = email;\n    if (displayName) claims.displayName = displayName;\n    if (screenName) claims.screenName = screenName;\n    if (photoUrl) claims.photoUrl = photoUrl;\n\n    finishWithUser(createFakeClaims(claims));\n  }\n});\n\ndocument.getElementById('back-button').addEventListener('click', function() {\n  toggleForm(false);\n});\n\nfunction createFakeClaims(info) {\n  return encodeURIComponent(JSON.stringify({\n    sub: randomProviderRawId(),\n    iss: \"\",\n    aud: \"\",\n    exp: 0,\n    iat: 0,\n    name: info.displayName,\n    screen_name: info.screenName,\n    email: info.email,\n    email_verified: true, // TODO: Shall we allow changing this?\n    picture: info.photoUrl,\n  }));\n}\n\nfunction randomProviderRawId() {\n  var str = '';\n  for (var i = 0; i < 40; i++) {\n    str += Math.floor(Math.random() * 10).toString();\n  }\n\n  return str;\n}\n\n\n// For now form validation only checks the email field.\nfunction validateForm() {\n  var emailInput = document.getElementById('email-input');\n  var valid = true;\n  var value = emailInput.value;\n\n  if (!value) {\n    valid = false;\n    emailErrorMessage('Email required');\n  } else if (value.indexOf('@') < 0) {\n    valid = false;\n    emailErrorMessage('Missing \"@\"');\n  } else {\n    emailErrorMessage('');\n  }\n\n  document.querySelector('#sign-in').disabled = !valid;\n\n  return valid;\n}\n\n// Generates random info for user creation\nfunction runAutogen() {\n  var emailInput = document.getElementById('email-input');\n  var displayInput = document.getElementById('display-name-input');\n  var screenInput = document.getElementById('screen-name-input');\n\n  var nameOptions = [\n    'raccoon',\n    'olive',\n    'orange',\n    'chicken',\n    'mountain',\n    'peach',\n    'panda',\n    'grass',\n    'algae',\n    'otter'\n  ];\n\n  var randomNumber = Math.floor(Math.random() * 1000);\n  var givenName = nameOptions[Math.floor(Math.random() * nameOptions.length)];\n  var familyName = nameOptions[Math.floor(Math.random() * nameOptions.length)];\n  emailInput.value = givenName + '.' + familyName + '.' + randomNumber + '@example.com';\n  displayInput.value = capitalize(givenName) + ' ' + capitalize(familyName);\n  screenInput.value = familyName + '_' + givenName;\n\n  emailInput.dispatchEvent(new Event('input'));\n  displayInput.dispatchEvent(new Event('input'));\n  screenInput.dispatchEvent(new Event('input'));\n}\n\nfunction emailErrorMessage(value) {\n  document.getElementById('email-error').innerText = value;\n}\n\nfunction capitalize(a) {\n  return a.charAt(0).toUpperCase() + a.slice(1);\n}\n\nfunction toggleForm(showForm) {\n  document.getElementById('add-user').style.display =\n      showForm ? 'block' : 'none';\n  document.getElementById('accounts-list').style.display =\n      showForm ? 'none' : 'block';\n}\n`;\nconst STYLE = `\n\n:root {\n  --mdc-theme-text-secondary-on-background: rgba(0,0,0,.56);\n}\n\nbody {\n  font-family: \"Roboto\", sans-serif;\n  margin: 0;\n  padding: 0;\n  width: 100%;\n}\n\np {\n  margin-block-end: 0em;\n  margin-block-start: 0em;\n}\n\nli {\n  padding: 8px 16px;\n  list-style-type: none;\n}\n\nul {\n  padding-inline-start: 0;\n}\n\nbutton {\n  text-transform: none !important;\n  letter-spacing: 0 !important;\n}\n\n#title {\n  align-items: center;\n  display: flex;\n  flex-direction: row;\n  font-size: 24px;\n  font-weight: 500;\n  margin-bottom: 16px;\n  margin-top: 32px;\n}\n\n#title > span {\n  flex: 1;\n}\n\n#title > button {\n  color: #858585;\n}\n\n.subtitle {\n color: var(--mdc-theme-text-secondary-on-background);\n font-size: 14px;\n line-height: 20px;\n margin-block-end: 0em;\n margin-block-start: 0em;\n}\n\n#content {\n  box-sizing: border-box;\n  margin: 16px auto;\n  max-width: 515px;\n  min-width: 300px;\n}\n\n.content-wrapper, .mdc-list--avatar-list .mdc-list-item {\n  padding: 0 24px;\n}\n\n.mdc-list .mdc-list-item__graphic {\n  align-items: center;\n  background-color: #c5c5c5;\n  background-size: contain;\n  border-radius: 50%;\n  color: #fff;\n  fill: currentColor;\n  flex-shrink: 0;\n  height: 36px;\n  justify-content: center;\n  margin-left: 0;\n  margin-right: 16px;\n  width: 36px;\n}\n\n#add-account-button {\n  height: 56px !important;\n}\n\n.callout {\n  background: #e5eaf0;\n  color: #476282;\n  display: flex;\n  flex-direction: row;\n  padding: 12px 24px;\n}\n\n.callout-warning {\n  background: #fff3e0;\n  color: #bf360c;\n}\n\n.callout .content {\n  flex: 1;\n  align-self: center;\n  font-size: 14px;\n  font-weight: 500;\n  margin-left: 8px;\n}\n\n/* Vertical Spaced */\n.vs {\n  margin-bottom: 16px;\n}\n\n.mdc-text-field {\n  height: 40px !important;\n  width: 100%;\n}\n\n.form-label {\n  color: rgba(0,0,0,.54);\n  display: block;\n  font-size: 12px;\n  margin: 0 0 4px 1px;\n}\n\n.custom-label {\n  color: rgba(0,0,0,.38);\n  display: inline-block;\n  margin-left: 4px;\n  transform: translateY(50%);\n}\n\n.error-info {\n  color: #C62828;\n  display: block;\n  font-size: 12px;\n  padding-top: 4px;\n}\n\n#main-action {\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n  margin-top: 15px;\n  width: 100%;\n}\n\n#back-button {\n  left: -8px;\n  position: relative;\n}\n\n#add-user {\n  display: none;\n}\n\n.fallback-secondary-text {\n  color: var(--mdc-theme-text-secondary-on-background);\n}\n\n`;\nexports.PROVIDERS_LIST_PLACEHOLDER = \"__PROVIDERS__\";\nexports.WIDGET_UI = `\n<!DOCTYPE html>\n<meta charset=\"utf-8\">\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n<title>Auth Emulator IDP Login Widget</title>\n<link href=\"https://unpkg.com/material-components-web@latest/dist/material-components-web.min.css\" rel=\"stylesheet\">\n<link href=\"https://fonts.googleapis.com/icon?family=Material+Icons\" rel=\"stylesheet\">\n<link href=\"https://fonts.googleapis.com/css2?family=Roboto:wght@400;500&display=swap\" rel=\"stylesheet\">\n<style>${STYLE}</style>\n<div id=\"content\">\n  <div class=\"content-wrapper\">\n    <div id=\"title\">\n      <span>Sign-in with <span class=\"js-provider-id provider-name\">Provider</span></span>\n    </div>\n  </div>\n  <div id=\"accounts-list\">\n    <div class=\"content-wrapper\">\n      <div class=\"callout callout-warning vs js-signin-warning\" style=\"display:none\">\n        <i class=\"material-icons\">error</i>\n        <div class=\"content\"></div>\n      </div>\n      <p class=\"subtitle js-accounts-help-text\">Please select an existing account in the Auth Emulator or add a new one:</p>\n    </div>\n    <ul class=\"mdc-list list mdc-list--two-line mdc-list--avatar-list\">\n      ${exports.PROVIDERS_LIST_PLACEHOLDER}\n      <li id=\"add-account-button\" class=\"js-new-account mdc-list-item\">\n        <button class=\"mdc-button mdc-button--outlined\">\n          <div class=\"mdc-button__ripple\"></div>\n            <i class=\"material-icons mdc-button__icon\" aria-hidden=\"true\">add</i>\n            <span class=\"mdc-button__label\">Add new account</span>\n          </button>\n      </li>\n    </ul>\n  </div>\n  <div id=\"add-user\">\n    <div class=\"content-wrapper\" id=\"form-content\">\n      <div class=\"callout vs\">\n        <i class=\"material-icons\">info</i>\n        <div class=\"content\">\n          Custom claims can be added after an account is created\n        </div>\n      </div>\n      <button id=\"autogen-button\" class=\"vs mdc-button mdc-button--outlined\" type=\"button\">\n        <div class=\"mdc-button__ripple\"></div>\n        <span class=\"mdc-button__label\">Auto-generate user information</span>\n      </button>\n      <form id=\"main-form\">\n        <span class=\"form-label\">Email</span>\n        <label class=\"mdc-text-field mdc-text-field--outlined\">\n          <input id=\"email-input\" type=\"text\"\n              class=\"mdc-text-field__input test\" aria-labelledby=\"my-label-id\">\n          <span class=\"mdc-notched-outline\">\n            <span class=\"mdc-notched-outline__leading\"></span>\n            <span class=\"mdc-notched-outline__notch\">\n            <span class=\"custom-label\" id=\"email-label\">Email</span>\n            </span>\n            <span class=\"mdc-notched-outline__trailing\"></span>\n          </span>\n        </label>\n        <span class=\"error-info vs\" id=\"email-error\"></span>\n\n        <span class=\"form-label\">Display name (optional)</span>\n        <label class=\"mdc-text-field mdc-text-field--outlined vs\">\n          <input id=\"display-name-input\" type=\"text\"\n              class=\"mdc-text-field__input test\" aria-labelledby=\"my-label-id\">\n          <span class=\"mdc-notched-outline\">\n            <span class=\"mdc-notched-outline__leading\"></span>\n            <span class=\"mdc-notched-outline__notch\">\n            <span class=\"custom-label\" id=\"email-label\">Display name</span>\n            </span>\n            <span class=\"mdc-notched-outline__trailing\"></span>\n          </span>\n        </label>\n\n        <span class=\"form-label\">Screen name (optional)</span>\n        <label class=\"mdc-text-field mdc-text-field--outlined vs\">\n          <input id=\"screen-name-input\" type=\"text\"\n              class=\"mdc-text-field__input test\" aria-labelledby=\"my-label-id\">\n          <span class=\"mdc-notched-outline\">\n            <span class=\"mdc-notched-outline__leading\"></span>\n            <span class=\"mdc-notched-outline__notch\">\n            <span class=\"custom-label\" id=\"email-label\">Screen name</span>\n            </span>\n            <span class=\"mdc-notched-outline__trailing\"></span>\n          </span>\n        </label>\n\n        <span class=\"form-label\">Profile photo URL (optional)</span>\n        <label class=\"mdc-text-field mdc-text-field--outlined vs\">\n          <input id=\"profile-photo-input\" type=\"text\"\n              class=\"mdc-text-field__input test\" aria-labelledby=\"my-label-id\">\n          <span class=\"mdc-notched-outline\">\n            <span class=\"mdc-notched-outline__leading\"></span>\n            <span class=\"mdc-notched-outline__notch\">\n            <span class=\"custom-label\" id=\"email-label\">Profile photo URL</span>\n            </span>\n            <span class=\"mdc-notched-outline__trailing\"></span>\n          </span>\n        </label>\n\n        <div id=\"main-action\" class=\"vs\">\n          <button class=\"mdc-button\" id=\"back-button\" type=\"button\">\n            <div class=\"mdc-button__ripple\"></div>\n            <i class=\"material-icons mdc-button__icon\" aria-hidden=\"true\"\n              >arrow_back</i\n            >\n            <span class=\"mdc-button__label\">Back</span>\n          </button>\n          <button class=\"mdc-button mdc-button--raised\" id=\"sign-in\" type=\"submit\">\n            <span class=\"mdc-button__label\">\n              Sign in with <span class=\"js-provider-id provider-name\">Provider</span>\n            </span>\n          </button>\n        </div>\n      </form>\n    </div>\n  </div>\n</div>\n<script src=\"https://unpkg.com/material-components-web@latest/dist/material-components-web.min.js\"></script>\n<script>${SCRIPT}</script>\n`;","map":{"version":3,"sources":["/home/dev/Documentos/Projects/github-clone/node_modules/firebase-tools/lib/emulator/auth/widget_ui.js"],"names":["Object","defineProperty","exports","value","WIDGET_UI","PROVIDERS_LIST_PLACEHOLDER","SCRIPT","STYLE"],"mappings":"AAAA;;AACAA,MAAM,CAACC,cAAP,CAAsBC,OAAtB,EAA+B,YAA/B,EAA6C;AAAEC,EAAAA,KAAK,EAAE;AAAT,CAA7C;AACAD,OAAO,CAACE,SAAR,GAAoBF,OAAO,CAACG,0BAAR,GAAqC,KAAK,CAA9D;AACA,MAAMC,MAAM,GAAI;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CA9TA;AA+TA,MAAMC,KAAK,GAAI;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAjKA;AAkKAL,OAAO,CAACG,0BAAR,GAAqC,eAArC;AACAH,OAAO,CAACE,SAAR,GAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAASG,KAAM;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQL,OAAO,CAACG,0BAA2B;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAUC,MAAO;AACjB,CAxHA","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.WIDGET_UI = exports.PROVIDERS_LIST_PLACEHOLDER = void 0;\nconst SCRIPT = `\nfunction assert(condition, error) {\n  if (!condition) {\n    if (!(error instanceof Error)) {\n      error = new Error('Auth Emulator Internal Error: ' + error);\n    }\n    // Show error with great visibility AND stops further user interactions.\n    document.body.textContent = error.stack || error.message;\n    document.body.style = 'color:red;white-space:pre';\n    throw error; // Halts current script and prints error to console.\n  }\n}\n\n// TODO: Support older browsers where URLSearchParams is not available.\nvar query = new URLSearchParams(location.search);\nvar internalError = query.get('error');\nassert(!internalError, internalError);\n\nvar apiKey = query.get('apiKey');\nvar appName = query.get('appName');\nvar authType = query.get('authType');\nvar providerId = query.get('providerId');\nvar redirectUrl = query.get('redirectUrl');\nvar scopes = query.get('scopes');\nvar eventId = query.get('eventId');\nvar storageKey = apiKey + ':' + appName;\n\nvar clientId = query.get('clientId');\nvar firebaseAppId = query.get('appId');\nvar apn = query.get('apn');\nvar ibi = query.get('ibi');\nvar appIdentifier = apn || ibi;\nassert(\n  appName || clientId || firebaseAppId || appIdentifier,\n  'Missing one of appName / clientId / appId / apn / ibi query params.'\n);\n\n// Warn the developer of a few flows only available in Auth Emulator.\nif ((providerId === 'facebook.com' && appIdentifier) || (providerId === 'apple.com' && ibi)) {\n  var providerName = (providerId === 'facebook.com') ? 'Facebook' : 'Apple';\n  var productionMethod = providerName + (apn ? ' Android SDK' : ' iOS SDK');\n  var warningEl = document.querySelector('.js-signin-warning');\n  warningEl.querySelector('.content').textContent =\n    'Sign-in with ' + providerName + ' via generic IDP is only supported in the Auth Emulator; ' +\n    'remember to switch to ' + productionMethod + ' for production Firebase projects.';\n  warningEl.style.display = 'flex';\n}\n\nfunction saveAuthEvent(authEvent) {\n  if (/popup/i.test(authType)) {\n    sendAuthEventViaIframeRelay(authEvent, function (err) {\n      assert(!err, err);\n    });\n  } else {\n    if (apn) {\n      redirectToAndroid(authEvent);\n    } else if (ibi) {\n      redirectToIos(authEvent);\n    } else if (redirectUrl) {\n      saveAuthEventToStorage(authEvent);\n      window.location = redirectUrl;\n    } else {\n      assert(false, 'This feature is not implemented in Auth Emulator yet. Please use signInWithCredential for now.');\n    }\n  }\n}\n\nfunction saveAuthEventToStorage(authEvent) {\n  sessionStorage['firebase:redirectEvent:' + storageKey] =\n    JSON.stringify(authEvent);\n}\n\nfunction sendAuthEventViaIframeRelay(authEvent, cb) {\n  var sent = false;\n  if (window.opener) {\n    for (var i = 0; i < window.opener.frames.length; i++) {\n      // Try/catch is necessary because without it, the code will crash the first time one of the frames does not have\n      // the same origin (from the iframeWin.location.search) and the loop will not reach the other frames.\n      try {\n        var iframeWin = window.opener.frames[i];\n        var query = new URLSearchParams(iframeWin.location.search);\n        if (query.get('apiKey') === apiKey && query.get('appName') === appName) {\n          iframeWin.postMessage({\n            data: {authEvent: authEvent, storageKey: storageKey},\n            eventId: Math.floor(Math.random() * Math.pow(10, 20)).toString(),\n            eventType: \"sendAuthEvent\",\n          }, '*');\n          sent = true;\n        }\n      } catch (e) {\n        // The frame does not have the same origin\n      }\n    }\n  }\n  if (!sent) {\n    return cb('No matching frame');\n  }\n  return cb();\n}\n\nfunction redirectToAndroid(authEvent) {\n  // This is shown when no app handles the link and displays an error.\n  var fallbackUrl = window.location.href + '&error=App+not+found+for+intent';\n\n  var link = 'intent://firebase.auth/#Intent;scheme=genericidp;' +\n      'package=' + apn + ';' +\n      'S.authType=' + authEvent.type + ';';\n  if (authEvent.eventId) {\n    link += 'S.eventId=' + authEvent.eventId + ';';\n  }\n  link += 'S.link=' + encodeURIComponent(authEvent.urlResponse) + ';';\n  link += 'B.encryptionEnabled=false;';\n  link += 'S.browser_fallback_url=' + encodeURIComponent(fallbackUrl) + ';';\n\n  link += 'end;';\n\n  window.location.replace(link);\n}\n\nfunction redirectToIos(authEvent) {\n  // This URL format is based on production widget and known to work with the\n  // iOS SDK. It does not matter that /__/auth/callback is not an actual page\n  // served by the Auth Emulator -- only the format and query params matter.\n  var url = window.location.protocol + '//' + window.location.host +\n      '/__/auth/callback?authType=' + encodeURIComponent(authEvent.type) +\n      '&link=' + encodeURIComponent(authEvent.urlResponse);\n  if (authEvent.eventId) {\n    url += '&eventId=' + authEvent.eventId;\n  }\n  var scheme;\n  if (clientId) {\n    scheme = clientId.split('.').reverse().join('.');\n  } else if (firebaseAppId) {\n    scheme = 'app-' + firebaseAppId.replace(/:/g, '-');\n  } else {\n    scheme = appIdentifier;\n  }\n  var deepLink = scheme + '://' +\n    (clientId || firebaseAppId ? 'firebaseauth' : 'google') + '/link';\n  deepLink += '?deep_link_id=' + encodeURIComponent(url);\n\n  window.location.replace(deepLink);\n}\n\n\n// DOM logic\n\nvar formattedProviderId = providerId[0].toUpperCase() + providerId.substring(1);\ndocument.querySelectorAll('.js-provider-id').forEach(function(e) {\n  e.textContent = formattedProviderId;\n});\n\nvar reuseAccountEls = document.querySelectorAll('.js-reuse-account');\nif (reuseAccountEls.length) {\n  [].forEach.call(reuseAccountEls, function (el) {\n    var urlEncodedIdToken = el.dataset.idToken;\n    el.addEventListener('click', function (e) {\n      e.preventDefault();\n      finishWithUser(urlEncodedIdToken);\n    });\n  });\n} else {\n  document.querySelector('.js-accounts-help-text').textContent = \"No \" + formattedProviderId + \" accounts exist in the Auth Emulator.\";\n}\n\nfunction finishWithUser(urlEncodedIdToken) {\n  // Use widget URL, but replace all query parameters (no apiKey etc.).\n  var url = window.location.href.split('?')[0];\n  // Avoid URLSearchParams for browser compatibility.\n  url += '?providerId=' + encodeURIComponent(providerId);\n  url += '&id_token=' + urlEncodedIdToken;\n  saveAuthEvent({\n    type: authType,\n    eventId: eventId,\n    urlResponse: url,\n    sessionId: \"ValueNotUsedByAuthEmulator\",\n    postBody: \"\",\n    tenantId: null,\n    error: null,\n  });\n}\n\ndocument.querySelector('.js-new-account').addEventListener('click', function (e) {\n  e.preventDefault();\n  toggleForm(true);\n});\n\nvar inputs = document.querySelectorAll('.mdc-text-field');\n// Set up styling and reactivity for inputs\ninputs.forEach(function (input) {\n  input.querySelector('input').addEventListener('input', function(e) {\n    var display = 'none';\n    if (!e.target.value) display = 'block';\n    input.querySelector('.custom-label').style.display = display;\n    validateForm();\n  });\n  window.mdc && mdc.textField.MDCTextField.attachTo(input);\n});\n\ndocument.getElementById('autogen-button').addEventListener('click', function() {\n  runAutogen();\n});\n\n// Handle form validation and submission\ndocument.getElementById('main-form').addEventListener('submit', function(e) {\n  e.preventDefault();\n  var valid = validateForm();\n  if (valid) {\n    var email = document.getElementById('email-input').value;\n    var displayName = document.getElementById('display-name-input').value;\n    var screenName = document.getElementById('screen-name-input').value;\n    var photoUrl = document.getElementById('profile-photo-input').value;\n    var claims = {};\n\n    if (email) claims.email = email;\n    if (displayName) claims.displayName = displayName;\n    if (screenName) claims.screenName = screenName;\n    if (photoUrl) claims.photoUrl = photoUrl;\n\n    finishWithUser(createFakeClaims(claims));\n  }\n});\n\ndocument.getElementById('back-button').addEventListener('click', function() {\n  toggleForm(false);\n});\n\nfunction createFakeClaims(info) {\n  return encodeURIComponent(JSON.stringify({\n    sub: randomProviderRawId(),\n    iss: \"\",\n    aud: \"\",\n    exp: 0,\n    iat: 0,\n    name: info.displayName,\n    screen_name: info.screenName,\n    email: info.email,\n    email_verified: true, // TODO: Shall we allow changing this?\n    picture: info.photoUrl,\n  }));\n}\n\nfunction randomProviderRawId() {\n  var str = '';\n  for (var i = 0; i < 40; i++) {\n    str += Math.floor(Math.random() * 10).toString();\n  }\n\n  return str;\n}\n\n\n// For now form validation only checks the email field.\nfunction validateForm() {\n  var emailInput = document.getElementById('email-input');\n  var valid = true;\n  var value = emailInput.value;\n\n  if (!value) {\n    valid = false;\n    emailErrorMessage('Email required');\n  } else if (value.indexOf('@') < 0) {\n    valid = false;\n    emailErrorMessage('Missing \"@\"');\n  } else {\n    emailErrorMessage('');\n  }\n\n  document.querySelector('#sign-in').disabled = !valid;\n\n  return valid;\n}\n\n// Generates random info for user creation\nfunction runAutogen() {\n  var emailInput = document.getElementById('email-input');\n  var displayInput = document.getElementById('display-name-input');\n  var screenInput = document.getElementById('screen-name-input');\n\n  var nameOptions = [\n    'raccoon',\n    'olive',\n    'orange',\n    'chicken',\n    'mountain',\n    'peach',\n    'panda',\n    'grass',\n    'algae',\n    'otter'\n  ];\n\n  var randomNumber = Math.floor(Math.random() * 1000);\n  var givenName = nameOptions[Math.floor(Math.random() * nameOptions.length)];\n  var familyName = nameOptions[Math.floor(Math.random() * nameOptions.length)];\n  emailInput.value = givenName + '.' + familyName + '.' + randomNumber + '@example.com';\n  displayInput.value = capitalize(givenName) + ' ' + capitalize(familyName);\n  screenInput.value = familyName + '_' + givenName;\n\n  emailInput.dispatchEvent(new Event('input'));\n  displayInput.dispatchEvent(new Event('input'));\n  screenInput.dispatchEvent(new Event('input'));\n}\n\nfunction emailErrorMessage(value) {\n  document.getElementById('email-error').innerText = value;\n}\n\nfunction capitalize(a) {\n  return a.charAt(0).toUpperCase() + a.slice(1);\n}\n\nfunction toggleForm(showForm) {\n  document.getElementById('add-user').style.display =\n      showForm ? 'block' : 'none';\n  document.getElementById('accounts-list').style.display =\n      showForm ? 'none' : 'block';\n}\n`;\nconst STYLE = `\n\n:root {\n  --mdc-theme-text-secondary-on-background: rgba(0,0,0,.56);\n}\n\nbody {\n  font-family: \"Roboto\", sans-serif;\n  margin: 0;\n  padding: 0;\n  width: 100%;\n}\n\np {\n  margin-block-end: 0em;\n  margin-block-start: 0em;\n}\n\nli {\n  padding: 8px 16px;\n  list-style-type: none;\n}\n\nul {\n  padding-inline-start: 0;\n}\n\nbutton {\n  text-transform: none !important;\n  letter-spacing: 0 !important;\n}\n\n#title {\n  align-items: center;\n  display: flex;\n  flex-direction: row;\n  font-size: 24px;\n  font-weight: 500;\n  margin-bottom: 16px;\n  margin-top: 32px;\n}\n\n#title > span {\n  flex: 1;\n}\n\n#title > button {\n  color: #858585;\n}\n\n.subtitle {\n color: var(--mdc-theme-text-secondary-on-background);\n font-size: 14px;\n line-height: 20px;\n margin-block-end: 0em;\n margin-block-start: 0em;\n}\n\n#content {\n  box-sizing: border-box;\n  margin: 16px auto;\n  max-width: 515px;\n  min-width: 300px;\n}\n\n.content-wrapper, .mdc-list--avatar-list .mdc-list-item {\n  padding: 0 24px;\n}\n\n.mdc-list .mdc-list-item__graphic {\n  align-items: center;\n  background-color: #c5c5c5;\n  background-size: contain;\n  border-radius: 50%;\n  color: #fff;\n  fill: currentColor;\n  flex-shrink: 0;\n  height: 36px;\n  justify-content: center;\n  margin-left: 0;\n  margin-right: 16px;\n  width: 36px;\n}\n\n#add-account-button {\n  height: 56px !important;\n}\n\n.callout {\n  background: #e5eaf0;\n  color: #476282;\n  display: flex;\n  flex-direction: row;\n  padding: 12px 24px;\n}\n\n.callout-warning {\n  background: #fff3e0;\n  color: #bf360c;\n}\n\n.callout .content {\n  flex: 1;\n  align-self: center;\n  font-size: 14px;\n  font-weight: 500;\n  margin-left: 8px;\n}\n\n/* Vertical Spaced */\n.vs {\n  margin-bottom: 16px;\n}\n\n.mdc-text-field {\n  height: 40px !important;\n  width: 100%;\n}\n\n.form-label {\n  color: rgba(0,0,0,.54);\n  display: block;\n  font-size: 12px;\n  margin: 0 0 4px 1px;\n}\n\n.custom-label {\n  color: rgba(0,0,0,.38);\n  display: inline-block;\n  margin-left: 4px;\n  transform: translateY(50%);\n}\n\n.error-info {\n  color: #C62828;\n  display: block;\n  font-size: 12px;\n  padding-top: 4px;\n}\n\n#main-action {\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n  margin-top: 15px;\n  width: 100%;\n}\n\n#back-button {\n  left: -8px;\n  position: relative;\n}\n\n#add-user {\n  display: none;\n}\n\n.fallback-secondary-text {\n  color: var(--mdc-theme-text-secondary-on-background);\n}\n\n`;\nexports.PROVIDERS_LIST_PLACEHOLDER = \"__PROVIDERS__\";\nexports.WIDGET_UI = `\n<!DOCTYPE html>\n<meta charset=\"utf-8\">\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n<title>Auth Emulator IDP Login Widget</title>\n<link href=\"https://unpkg.com/material-components-web@latest/dist/material-components-web.min.css\" rel=\"stylesheet\">\n<link href=\"https://fonts.googleapis.com/icon?family=Material+Icons\" rel=\"stylesheet\">\n<link href=\"https://fonts.googleapis.com/css2?family=Roboto:wght@400;500&display=swap\" rel=\"stylesheet\">\n<style>${STYLE}</style>\n<div id=\"content\">\n  <div class=\"content-wrapper\">\n    <div id=\"title\">\n      <span>Sign-in with <span class=\"js-provider-id provider-name\">Provider</span></span>\n    </div>\n  </div>\n  <div id=\"accounts-list\">\n    <div class=\"content-wrapper\">\n      <div class=\"callout callout-warning vs js-signin-warning\" style=\"display:none\">\n        <i class=\"material-icons\">error</i>\n        <div class=\"content\"></div>\n      </div>\n      <p class=\"subtitle js-accounts-help-text\">Please select an existing account in the Auth Emulator or add a new one:</p>\n    </div>\n    <ul class=\"mdc-list list mdc-list--two-line mdc-list--avatar-list\">\n      ${exports.PROVIDERS_LIST_PLACEHOLDER}\n      <li id=\"add-account-button\" class=\"js-new-account mdc-list-item\">\n        <button class=\"mdc-button mdc-button--outlined\">\n          <div class=\"mdc-button__ripple\"></div>\n            <i class=\"material-icons mdc-button__icon\" aria-hidden=\"true\">add</i>\n            <span class=\"mdc-button__label\">Add new account</span>\n          </button>\n      </li>\n    </ul>\n  </div>\n  <div id=\"add-user\">\n    <div class=\"content-wrapper\" id=\"form-content\">\n      <div class=\"callout vs\">\n        <i class=\"material-icons\">info</i>\n        <div class=\"content\">\n          Custom claims can be added after an account is created\n        </div>\n      </div>\n      <button id=\"autogen-button\" class=\"vs mdc-button mdc-button--outlined\" type=\"button\">\n        <div class=\"mdc-button__ripple\"></div>\n        <span class=\"mdc-button__label\">Auto-generate user information</span>\n      </button>\n      <form id=\"main-form\">\n        <span class=\"form-label\">Email</span>\n        <label class=\"mdc-text-field mdc-text-field--outlined\">\n          <input id=\"email-input\" type=\"text\"\n              class=\"mdc-text-field__input test\" aria-labelledby=\"my-label-id\">\n          <span class=\"mdc-notched-outline\">\n            <span class=\"mdc-notched-outline__leading\"></span>\n            <span class=\"mdc-notched-outline__notch\">\n            <span class=\"custom-label\" id=\"email-label\">Email</span>\n            </span>\n            <span class=\"mdc-notched-outline__trailing\"></span>\n          </span>\n        </label>\n        <span class=\"error-info vs\" id=\"email-error\"></span>\n\n        <span class=\"form-label\">Display name (optional)</span>\n        <label class=\"mdc-text-field mdc-text-field--outlined vs\">\n          <input id=\"display-name-input\" type=\"text\"\n              class=\"mdc-text-field__input test\" aria-labelledby=\"my-label-id\">\n          <span class=\"mdc-notched-outline\">\n            <span class=\"mdc-notched-outline__leading\"></span>\n            <span class=\"mdc-notched-outline__notch\">\n            <span class=\"custom-label\" id=\"email-label\">Display name</span>\n            </span>\n            <span class=\"mdc-notched-outline__trailing\"></span>\n          </span>\n        </label>\n\n        <span class=\"form-label\">Screen name (optional)</span>\n        <label class=\"mdc-text-field mdc-text-field--outlined vs\">\n          <input id=\"screen-name-input\" type=\"text\"\n              class=\"mdc-text-field__input test\" aria-labelledby=\"my-label-id\">\n          <span class=\"mdc-notched-outline\">\n            <span class=\"mdc-notched-outline__leading\"></span>\n            <span class=\"mdc-notched-outline__notch\">\n            <span class=\"custom-label\" id=\"email-label\">Screen name</span>\n            </span>\n            <span class=\"mdc-notched-outline__trailing\"></span>\n          </span>\n        </label>\n\n        <span class=\"form-label\">Profile photo URL (optional)</span>\n        <label class=\"mdc-text-field mdc-text-field--outlined vs\">\n          <input id=\"profile-photo-input\" type=\"text\"\n              class=\"mdc-text-field__input test\" aria-labelledby=\"my-label-id\">\n          <span class=\"mdc-notched-outline\">\n            <span class=\"mdc-notched-outline__leading\"></span>\n            <span class=\"mdc-notched-outline__notch\">\n            <span class=\"custom-label\" id=\"email-label\">Profile photo URL</span>\n            </span>\n            <span class=\"mdc-notched-outline__trailing\"></span>\n          </span>\n        </label>\n\n        <div id=\"main-action\" class=\"vs\">\n          <button class=\"mdc-button\" id=\"back-button\" type=\"button\">\n            <div class=\"mdc-button__ripple\"></div>\n            <i class=\"material-icons mdc-button__icon\" aria-hidden=\"true\"\n              >arrow_back</i\n            >\n            <span class=\"mdc-button__label\">Back</span>\n          </button>\n          <button class=\"mdc-button mdc-button--raised\" id=\"sign-in\" type=\"submit\">\n            <span class=\"mdc-button__label\">\n              Sign in with <span class=\"js-provider-id provider-name\">Provider</span>\n            </span>\n          </button>\n        </div>\n      </form>\n    </div>\n  </div>\n</div>\n<script src=\"https://unpkg.com/material-components-web@latest/dist/material-components-web.min.js\"></script>\n<script>${SCRIPT}</script>\n`;\n"]},"metadata":{},"sourceType":"script"}