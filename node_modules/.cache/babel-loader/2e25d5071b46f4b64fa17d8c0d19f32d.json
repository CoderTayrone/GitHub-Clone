{"ast":null,"code":"\"use strict\";\n\nvar api = require(\"../api\");\n\nvar utils = require(\"../utils\");\n\nconst {\n  logger\n} = require(\"../logger\");\n\nvar _ = require(\"lodash\");\n\nvar API_VERSION = \"v1beta1\";\n\nfunction _listConfigs(projectId) {\n  return api.request(\"GET\", utils.endpoint([API_VERSION, \"projects\", projectId, \"configs\"]), {\n    auth: true,\n    origin: api.runtimeconfigOrigin,\n    retryCodes: [500, 503]\n  }).then(function (resp) {\n    return Promise.resolve(resp.body.configs);\n  });\n}\n\nfunction _createConfig(projectId, configId) {\n  var path = _.join([\"projects\", projectId, \"configs\"], \"/\");\n\n  var endpoint = utils.endpoint([API_VERSION, path]);\n  return api.request(\"POST\", endpoint, {\n    auth: true,\n    origin: api.runtimeconfigOrigin,\n    data: {\n      name: path + \"/\" + configId\n    },\n    retryCodes: [500, 503]\n  }).catch(function (err) {\n    if (_.get(err, \"context.response.statusCode\") === 409) {\n      return Promise.resolve();\n    }\n\n    return Promise.reject(err);\n  });\n}\n\nfunction _deleteConfig(projectId, configId) {\n  return api.request(\"DELETE\", utils.endpoint([API_VERSION, \"projects\", projectId, \"configs\", configId]), {\n    auth: true,\n    origin: api.runtimeconfigOrigin,\n    retryCodes: [500, 503]\n  }).catch(function (err) {\n    if (_.get(err, \"context.response.statusCode\") === 404) {\n      logger.debug(\"Config already deleted.\");\n      return Promise.resolve();\n    }\n\n    return Promise.reject(err);\n  });\n}\n\nfunction _listVariables(configPath) {\n  return api.request(\"GET\", utils.endpoint([API_VERSION, configPath, \"variables\"]), {\n    auth: true,\n    origin: api.runtimeconfigOrigin,\n    retryCodes: [500, 503]\n  }).then(function (resp) {\n    return Promise.resolve(resp.body.variables);\n  });\n}\n\nfunction _getVariable(varPath) {\n  return api.request(\"GET\", utils.endpoint([API_VERSION, varPath]), {\n    auth: true,\n    origin: api.runtimeconfigOrigin,\n    retryCodes: [500, 503]\n  }).then(function (resp) {\n    return Promise.resolve(resp.body);\n  });\n}\n\nfunction _createVariable(projectId, configId, varId, value) {\n  var path = _.join([\"projects\", projectId, \"configs\", configId, \"variables\"], \"/\");\n\n  var endpoint = utils.endpoint([API_VERSION, path]);\n  return api.request(\"POST\", endpoint, {\n    auth: true,\n    origin: api.runtimeconfigOrigin,\n    data: {\n      name: path + \"/\" + varId,\n      text: value\n    },\n    retryCodes: [500, 503]\n  }).catch(function (err) {\n    if (_.get(err, \"context.response.statusCode\") === 404) {\n      return _createConfig(projectId, configId).then(function () {\n        return _createVariable(projectId, configId, varId, value);\n      });\n    }\n\n    return Promise.reject(err);\n  });\n}\n\nfunction _updateVariable(projectId, configId, varId, value) {\n  var path = _.join([\"projects\", projectId, \"configs\", configId, \"variables\", varId], \"/\");\n\n  var endpoint = utils.endpoint([API_VERSION, path]);\n  return api.request(\"PUT\", endpoint, {\n    auth: true,\n    origin: api.runtimeconfigOrigin,\n    data: {\n      name: path,\n      text: value\n    },\n    retryCodes: [500, 503]\n  });\n}\n\nfunction _setVariable(projectId, configId, varId, value) {\n  var path = _.join([\"projects\", projectId, \"configs\", configId, \"variables\", varId], \"/\");\n\n  return _getVariable(path).then(function () {\n    return _updateVariable(projectId, configId, varId, value);\n  }).catch(function (err) {\n    if (_.get(err, \"context.response.statusCode\") === 404) {\n      return _createVariable(projectId, configId, varId, value);\n    }\n\n    return Promise.reject(err);\n  });\n}\n\nfunction _deleteVariable(projectId, configId, varId) {\n  var endpoint = utils.endpoint([API_VERSION, \"projects\", projectId, \"configs\", configId, \"variables\", varId]) + \"?recursive=true\";\n  return api.request(\"DELETE\", endpoint, {\n    auth: true,\n    origin: api.runtimeconfigOrigin,\n    retryCodes: [500, 503]\n  }).catch(function (err) {\n    if (_.get(err, \"context.response.statusCode\") === 404) {\n      logger.debug(\"Variable already deleted.\");\n      return Promise.resolve();\n    }\n\n    return Promise.reject(err);\n  });\n}\n\nmodule.exports = {\n  configs: {\n    list: _listConfigs,\n    create: _createConfig,\n    delete: _deleteConfig\n  },\n  variables: {\n    list: _listVariables,\n    get: _getVariable,\n    set: _setVariable,\n    delete: _deleteVariable\n  }\n};","map":{"version":3,"sources":["/home/dev/Documentos/Projects/github-clone/node_modules/firebase-tools/lib/gcp/runtimeconfig.js"],"names":["api","require","utils","logger","_","API_VERSION","_listConfigs","projectId","request","endpoint","auth","origin","runtimeconfigOrigin","retryCodes","then","resp","Promise","resolve","body","configs","_createConfig","configId","path","join","data","name","catch","err","get","reject","_deleteConfig","debug","_listVariables","configPath","variables","_getVariable","varPath","_createVariable","varId","value","text","_updateVariable","_setVariable","_deleteVariable","module","exports","list","create","delete","set"],"mappings":"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","sourcesContent":["\"use strict\";\nvar api = require(\"../api\");\nvar utils = require(\"../utils\");\nconst { logger } = require(\"../logger\");\nvar _ = require(\"lodash\");\nvar API_VERSION = \"v1beta1\";\nfunction _listConfigs(projectId) {\n    return api\n        .request(\"GET\", utils.endpoint([API_VERSION, \"projects\", projectId, \"configs\"]), {\n        auth: true,\n        origin: api.runtimeconfigOrigin,\n        retryCodes: [500, 503],\n    })\n        .then(function (resp) {\n        return Promise.resolve(resp.body.configs);\n    });\n}\nfunction _createConfig(projectId, configId) {\n    var path = _.join([\"projects\", projectId, \"configs\"], \"/\");\n    var endpoint = utils.endpoint([API_VERSION, path]);\n    return api\n        .request(\"POST\", endpoint, {\n        auth: true,\n        origin: api.runtimeconfigOrigin,\n        data: {\n            name: path + \"/\" + configId,\n        },\n        retryCodes: [500, 503],\n    })\n        .catch(function (err) {\n        if (_.get(err, \"context.response.statusCode\") === 409) {\n            return Promise.resolve();\n        }\n        return Promise.reject(err);\n    });\n}\nfunction _deleteConfig(projectId, configId) {\n    return api\n        .request(\"DELETE\", utils.endpoint([API_VERSION, \"projects\", projectId, \"configs\", configId]), {\n        auth: true,\n        origin: api.runtimeconfigOrigin,\n        retryCodes: [500, 503],\n    })\n        .catch(function (err) {\n        if (_.get(err, \"context.response.statusCode\") === 404) {\n            logger.debug(\"Config already deleted.\");\n            return Promise.resolve();\n        }\n        return Promise.reject(err);\n    });\n}\nfunction _listVariables(configPath) {\n    return api\n        .request(\"GET\", utils.endpoint([API_VERSION, configPath, \"variables\"]), {\n        auth: true,\n        origin: api.runtimeconfigOrigin,\n        retryCodes: [500, 503],\n    })\n        .then(function (resp) {\n        return Promise.resolve(resp.body.variables);\n    });\n}\nfunction _getVariable(varPath) {\n    return api\n        .request(\"GET\", utils.endpoint([API_VERSION, varPath]), {\n        auth: true,\n        origin: api.runtimeconfigOrigin,\n        retryCodes: [500, 503],\n    })\n        .then(function (resp) {\n        return Promise.resolve(resp.body);\n    });\n}\nfunction _createVariable(projectId, configId, varId, value) {\n    var path = _.join([\"projects\", projectId, \"configs\", configId, \"variables\"], \"/\");\n    var endpoint = utils.endpoint([API_VERSION, path]);\n    return api\n        .request(\"POST\", endpoint, {\n        auth: true,\n        origin: api.runtimeconfigOrigin,\n        data: {\n            name: path + \"/\" + varId,\n            text: value,\n        },\n        retryCodes: [500, 503],\n    })\n        .catch(function (err) {\n        if (_.get(err, \"context.response.statusCode\") === 404) {\n            return _createConfig(projectId, configId).then(function () {\n                return _createVariable(projectId, configId, varId, value);\n            });\n        }\n        return Promise.reject(err);\n    });\n}\nfunction _updateVariable(projectId, configId, varId, value) {\n    var path = _.join([\"projects\", projectId, \"configs\", configId, \"variables\", varId], \"/\");\n    var endpoint = utils.endpoint([API_VERSION, path]);\n    return api.request(\"PUT\", endpoint, {\n        auth: true,\n        origin: api.runtimeconfigOrigin,\n        data: {\n            name: path,\n            text: value,\n        },\n        retryCodes: [500, 503],\n    });\n}\nfunction _setVariable(projectId, configId, varId, value) {\n    var path = _.join([\"projects\", projectId, \"configs\", configId, \"variables\", varId], \"/\");\n    return _getVariable(path)\n        .then(function () {\n        return _updateVariable(projectId, configId, varId, value);\n    })\n        .catch(function (err) {\n        if (_.get(err, \"context.response.statusCode\") === 404) {\n            return _createVariable(projectId, configId, varId, value);\n        }\n        return Promise.reject(err);\n    });\n}\nfunction _deleteVariable(projectId, configId, varId) {\n    var endpoint = utils.endpoint([API_VERSION, \"projects\", projectId, \"configs\", configId, \"variables\", varId]) +\n        \"?recursive=true\";\n    return api\n        .request(\"DELETE\", endpoint, {\n        auth: true,\n        origin: api.runtimeconfigOrigin,\n        retryCodes: [500, 503],\n    })\n        .catch(function (err) {\n        if (_.get(err, \"context.response.statusCode\") === 404) {\n            logger.debug(\"Variable already deleted.\");\n            return Promise.resolve();\n        }\n        return Promise.reject(err);\n    });\n}\nmodule.exports = {\n    configs: {\n        list: _listConfigs,\n        create: _createConfig,\n        delete: _deleteConfig,\n    },\n    variables: {\n        list: _listVariables,\n        get: _getVariable,\n        set: _setVariable,\n        delete: _deleteVariable,\n    },\n};\n"]},"metadata":{},"sourceType":"script"}