{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.deleteAppAndroidSha = exports.createAppAndroidSha = exports.listAppAndroidSha = exports.getAppConfig = exports.getAppConfigFile = exports.listFirebaseApps = exports.createWebApp = exports.createAndroidApp = exports.createIosApp = exports.getAppPlatform = exports.ShaCertificateType = exports.AppPlatform = void 0;\n\nconst fs = require(\"fs\");\n\nconst api = require(\"../api\");\n\nconst error_1 = require(\"../error\");\n\nconst logger_1 = require(\"../logger\");\n\nconst operation_poller_1 = require(\"../operation-poller\");\n\nconst TIMEOUT_MILLIS = 30000;\nconst APP_LIST_PAGE_SIZE = 100;\nconst CREATE_APP_API_REQUEST_TIMEOUT_MILLIS = 15000;\nconst WEB_CONFIG_FILE_NAME = \"google-config.js\";\nvar AppPlatform;\n\n(function (AppPlatform) {\n  AppPlatform[\"PLATFORM_UNSPECIFIED\"] = \"PLATFORM_UNSPECIFIED\";\n  AppPlatform[\"IOS\"] = \"IOS\";\n  AppPlatform[\"ANDROID\"] = \"ANDROID\";\n  AppPlatform[\"WEB\"] = \"WEB\";\n  AppPlatform[\"ANY\"] = \"ANY\";\n})(AppPlatform = exports.AppPlatform || (exports.AppPlatform = {}));\n\nvar ShaCertificateType;\n\n(function (ShaCertificateType) {\n  ShaCertificateType[\"SHA_CERTIFICATE_TYPE_UNSPECIFIED\"] = \"SHA_CERTIFICATE_TYPE_UNSPECIFIED\";\n  ShaCertificateType[\"SHA_1\"] = \"SHA_1\";\n  ShaCertificateType[\"SHA_256\"] = \"SHA_256\";\n})(ShaCertificateType = exports.ShaCertificateType || (exports.ShaCertificateType = {}));\n\nfunction getAppPlatform(platform) {\n  switch (platform.toUpperCase()) {\n    case \"IOS\":\n      return AppPlatform.IOS;\n\n    case \"ANDROID\":\n      return AppPlatform.ANDROID;\n\n    case \"WEB\":\n      return AppPlatform.WEB;\n\n    case \"\":\n      return AppPlatform.ANY;\n\n    default:\n      throw new error_1.FirebaseError(\"Unexpected platform. Only iOS, Android, and Web apps are supported\");\n  }\n}\n\nexports.getAppPlatform = getAppPlatform;\n\nasync function createIosApp(projectId, options) {\n  try {\n    const response = await api.request(\"POST\", `/v1beta1/projects/${projectId}/iosApps`, {\n      auth: true,\n      origin: api.firebaseApiOrigin,\n      timeout: CREATE_APP_API_REQUEST_TIMEOUT_MILLIS,\n      data: options\n    });\n    const appData = await operation_poller_1.pollOperation({\n      pollerName: \"Create iOS app Poller\",\n      apiOrigin: api.firebaseApiOrigin,\n      apiVersion: \"v1beta1\",\n      operationResourceName: response.body.name\n    });\n    return appData;\n  } catch (err) {\n    logger_1.logger.debug(err.message);\n    throw new error_1.FirebaseError(`Failed to create iOS app for project ${projectId}. See firebase-debug.log for more info.`, {\n      exit: 2,\n      original: err\n    });\n  }\n}\n\nexports.createIosApp = createIosApp;\n\nasync function createAndroidApp(projectId, options) {\n  try {\n    const response = await api.request(\"POST\", `/v1beta1/projects/${projectId}/androidApps`, {\n      auth: true,\n      origin: api.firebaseApiOrigin,\n      timeout: CREATE_APP_API_REQUEST_TIMEOUT_MILLIS,\n      data: options\n    });\n    const appData = await operation_poller_1.pollOperation({\n      pollerName: \"Create Android app Poller\",\n      apiOrigin: api.firebaseApiOrigin,\n      apiVersion: \"v1beta1\",\n      operationResourceName: response.body.name\n    });\n    return appData;\n  } catch (err) {\n    logger_1.logger.debug(err.message);\n    throw new error_1.FirebaseError(`Failed to create Android app for project ${projectId}. See firebase-debug.log for more info.`, {\n      exit: 2,\n      original: err\n    });\n  }\n}\n\nexports.createAndroidApp = createAndroidApp;\n\nasync function createWebApp(projectId, options) {\n  try {\n    const response = await api.request(\"POST\", `/v1beta1/projects/${projectId}/webApps`, {\n      auth: true,\n      origin: api.firebaseApiOrigin,\n      timeout: CREATE_APP_API_REQUEST_TIMEOUT_MILLIS,\n      data: options\n    });\n    const appData = await operation_poller_1.pollOperation({\n      pollerName: \"Create Web app Poller\",\n      apiOrigin: api.firebaseApiOrigin,\n      apiVersion: \"v1beta1\",\n      operationResourceName: response.body.name\n    });\n    return appData;\n  } catch (err) {\n    logger_1.logger.debug(err.message);\n    throw new error_1.FirebaseError(`Failed to create Web app for project ${projectId}. See firebase-debug.log for more info.`, {\n      exit: 2,\n      original: err\n    });\n  }\n}\n\nexports.createWebApp = createWebApp;\n\nfunction getListAppsResourceString(projectId, platform) {\n  let resourceSuffix;\n\n  switch (platform) {\n    case AppPlatform.IOS:\n      resourceSuffix = \"/iosApps\";\n      break;\n\n    case AppPlatform.ANDROID:\n      resourceSuffix = \"/androidApps\";\n      break;\n\n    case AppPlatform.WEB:\n      resourceSuffix = \"/webApps\";\n      break;\n\n    case AppPlatform.ANY:\n      resourceSuffix = \":searchApps\";\n      break;\n\n    default:\n      throw new error_1.FirebaseError(\"Unexpected platform. Only support iOS, Android and Web apps\");\n  }\n\n  return `/v1beta1/projects/${projectId}${resourceSuffix}`;\n}\n\nasync function listFirebaseApps(projectId, platform, pageSize = APP_LIST_PAGE_SIZE) {\n  const apps = [];\n\n  try {\n    let nextPageToken = \"\";\n\n    do {\n      const pageTokenQueryString = nextPageToken ? `&pageToken=${nextPageToken}` : \"\";\n      const response = await api.request(\"GET\", getListAppsResourceString(projectId, platform) + `?pageSize=${pageSize}${pageTokenQueryString}`, {\n        auth: true,\n        origin: api.firebaseApiOrigin,\n        timeout: TIMEOUT_MILLIS\n      });\n\n      if (response.body.apps) {\n        const appsOnPage = response.body.apps.map(app => app.platform ? app : Object.assign(Object.assign({}, app), {\n          platform\n        }));\n        apps.push(...appsOnPage);\n      }\n\n      nextPageToken = response.body.nextPageToken;\n    } while (nextPageToken);\n\n    return apps;\n  } catch (err) {\n    logger_1.logger.debug(err.message);\n    throw new error_1.FirebaseError(`Failed to list Firebase ${platform === AppPlatform.ANY ? \"\" : platform + \" \"}` + \"apps. See firebase-debug.log for more info.\", {\n      exit: 2,\n      original: err\n    });\n  }\n}\n\nexports.listFirebaseApps = listFirebaseApps;\n\nfunction getAppConfigResourceString(appId, platform) {\n  let platformResource;\n\n  switch (platform) {\n    case AppPlatform.IOS:\n      platformResource = \"iosApps\";\n      break;\n\n    case AppPlatform.ANDROID:\n      platformResource = \"androidApps\";\n      break;\n\n    case AppPlatform.WEB:\n      platformResource = \"webApps\";\n      break;\n\n    default:\n      throw new error_1.FirebaseError(\"Unexpected app platform\");\n  }\n\n  return `/v1beta1/projects/-/${platformResource}/${appId}/config`;\n}\n\nfunction parseConfigFromResponse(responseBody, platform) {\n  if (platform === AppPlatform.WEB) {\n    const JS_TEMPLATE = fs.readFileSync(__dirname + \"/../../templates/setup/web.js\", \"utf8\");\n    return {\n      fileName: WEB_CONFIG_FILE_NAME,\n      fileContents: JS_TEMPLATE.replace(\"{/*--CONFIG--*/}\", JSON.stringify(responseBody, null, 2))\n    };\n  } else if (platform === AppPlatform.ANDROID || platform === AppPlatform.IOS) {\n    return {\n      fileName: responseBody.configFilename,\n      fileContents: Buffer.from(responseBody.configFileContents, \"base64\").toString(\"utf8\")\n    };\n  }\n\n  throw new error_1.FirebaseError(\"Unexpected app platform\");\n}\n\nfunction getAppConfigFile(config, platform) {\n  return parseConfigFromResponse(config, platform);\n}\n\nexports.getAppConfigFile = getAppConfigFile;\n\nasync function getAppConfig(appId, platform) {\n  let response;\n\n  try {\n    response = await api.request(\"GET\", getAppConfigResourceString(appId, platform), {\n      auth: true,\n      origin: api.firebaseApiOrigin,\n      timeout: TIMEOUT_MILLIS\n    });\n  } catch (err) {\n    logger_1.logger.debug(err.message);\n    throw new error_1.FirebaseError(`Failed to get ${platform} app configuration. See firebase-debug.log for more info.`, {\n      exit: 2,\n      original: err\n    });\n  }\n\n  return response.body;\n}\n\nexports.getAppConfig = getAppConfig;\n\nasync function listAppAndroidSha(projectId, appId) {\n  const shaCertificates = [];\n\n  try {\n    const response = await api.request(\"GET\", `/v1beta1/projects/${projectId}/androidApps/${appId}/sha`, {\n      auth: true,\n      origin: api.firebaseApiOrigin\n    });\n\n    if (response.body.certificates) {\n      shaCertificates.push(...response.body.certificates);\n    }\n\n    return shaCertificates;\n  } catch (err) {\n    logger_1.logger.debug(err.message);\n    throw new error_1.FirebaseError(`Failed to list SHA certificate hashes for Android app ${appId}.` + \" See firebase-debug.log for more info.\", {\n      exit: 2,\n      original: err\n    });\n  }\n}\n\nexports.listAppAndroidSha = listAppAndroidSha;\n\nasync function createAppAndroidSha(projectId, appId, options) {\n  try {\n    const response = await api.request(\"POST\", `/v1beta1/projects/${projectId}/androidApps/${appId}/sha`, {\n      auth: true,\n      origin: api.firebaseApiOrigin,\n      timeout: CREATE_APP_API_REQUEST_TIMEOUT_MILLIS,\n      data: options\n    });\n    const shaCertificate = response.body;\n    return shaCertificate;\n  } catch (err) {\n    logger_1.logger.debug(err.message);\n    throw new error_1.FirebaseError(`Failed to create SHA certificate hash for Android app ${appId}. See firebase-debug.log for more info.`, {\n      exit: 2,\n      original: err\n    });\n  }\n}\n\nexports.createAppAndroidSha = createAppAndroidSha;\n\nasync function deleteAppAndroidSha(projectId, appId, shaId) {\n  try {\n    await api.request(\"DELETE\", `/v1beta1/projects/${projectId}/androidApps/${appId}/sha/${shaId}`, {\n      auth: true,\n      origin: api.firebaseApiOrigin,\n      timeout: CREATE_APP_API_REQUEST_TIMEOUT_MILLIS,\n      data: null\n    });\n  } catch (err) {\n    logger_1.logger.debug(err.message);\n    throw new error_1.FirebaseError(`Failed to delete SHA certificate hash for Android app ${appId}. See firebase-debug.log for more info.`, {\n      exit: 2,\n      original: err\n    });\n  }\n}\n\nexports.deleteAppAndroidSha = deleteAppAndroidSha;","map":{"version":3,"sources":["/home/dev/Documentos/Projects/github-clone/node_modules/firebase-tools/lib/management/apps.js"],"names":["Object","defineProperty","exports","value","deleteAppAndroidSha","createAppAndroidSha","listAppAndroidSha","getAppConfig","getAppConfigFile","listFirebaseApps","createWebApp","createAndroidApp","createIosApp","getAppPlatform","ShaCertificateType","AppPlatform","fs","require","api","error_1","logger_1","operation_poller_1","TIMEOUT_MILLIS","APP_LIST_PAGE_SIZE","CREATE_APP_API_REQUEST_TIMEOUT_MILLIS","WEB_CONFIG_FILE_NAME","platform","toUpperCase","IOS","ANDROID","WEB","ANY","FirebaseError","projectId","options","response","request","auth","origin","firebaseApiOrigin","timeout","data","appData","pollOperation","pollerName","apiOrigin","apiVersion","operationResourceName","body","name","err","logger","debug","message","exit","original","getListAppsResourceString","resourceSuffix","pageSize","apps","nextPageToken","pageTokenQueryString","appsOnPage","map","app","assign","push","getAppConfigResourceString","appId","platformResource","parseConfigFromResponse","responseBody","JS_TEMPLATE","readFileSync","__dirname","fileName","fileContents","replace","JSON","stringify","configFilename","Buffer","from","configFileContents","toString","config","shaCertificates","certificates","shaCertificate","shaId"],"mappings":"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","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.deleteAppAndroidSha = exports.createAppAndroidSha = exports.listAppAndroidSha = exports.getAppConfig = exports.getAppConfigFile = exports.listFirebaseApps = exports.createWebApp = exports.createAndroidApp = exports.createIosApp = exports.getAppPlatform = exports.ShaCertificateType = exports.AppPlatform = void 0;\nconst fs = require(\"fs\");\nconst api = require(\"../api\");\nconst error_1 = require(\"../error\");\nconst logger_1 = require(\"../logger\");\nconst operation_poller_1 = require(\"../operation-poller\");\nconst TIMEOUT_MILLIS = 30000;\nconst APP_LIST_PAGE_SIZE = 100;\nconst CREATE_APP_API_REQUEST_TIMEOUT_MILLIS = 15000;\nconst WEB_CONFIG_FILE_NAME = \"google-config.js\";\nvar AppPlatform;\n(function (AppPlatform) {\n    AppPlatform[\"PLATFORM_UNSPECIFIED\"] = \"PLATFORM_UNSPECIFIED\";\n    AppPlatform[\"IOS\"] = \"IOS\";\n    AppPlatform[\"ANDROID\"] = \"ANDROID\";\n    AppPlatform[\"WEB\"] = \"WEB\";\n    AppPlatform[\"ANY\"] = \"ANY\";\n})(AppPlatform = exports.AppPlatform || (exports.AppPlatform = {}));\nvar ShaCertificateType;\n(function (ShaCertificateType) {\n    ShaCertificateType[\"SHA_CERTIFICATE_TYPE_UNSPECIFIED\"] = \"SHA_CERTIFICATE_TYPE_UNSPECIFIED\";\n    ShaCertificateType[\"SHA_1\"] = \"SHA_1\";\n    ShaCertificateType[\"SHA_256\"] = \"SHA_256\";\n})(ShaCertificateType = exports.ShaCertificateType || (exports.ShaCertificateType = {}));\nfunction getAppPlatform(platform) {\n    switch (platform.toUpperCase()) {\n        case \"IOS\":\n            return AppPlatform.IOS;\n        case \"ANDROID\":\n            return AppPlatform.ANDROID;\n        case \"WEB\":\n            return AppPlatform.WEB;\n        case \"\":\n            return AppPlatform.ANY;\n        default:\n            throw new error_1.FirebaseError(\"Unexpected platform. Only iOS, Android, and Web apps are supported\");\n    }\n}\nexports.getAppPlatform = getAppPlatform;\nasync function createIosApp(projectId, options) {\n    try {\n        const response = await api.request(\"POST\", `/v1beta1/projects/${projectId}/iosApps`, {\n            auth: true,\n            origin: api.firebaseApiOrigin,\n            timeout: CREATE_APP_API_REQUEST_TIMEOUT_MILLIS,\n            data: options,\n        });\n        const appData = await operation_poller_1.pollOperation({\n            pollerName: \"Create iOS app Poller\",\n            apiOrigin: api.firebaseApiOrigin,\n            apiVersion: \"v1beta1\",\n            operationResourceName: response.body.name,\n        });\n        return appData;\n    }\n    catch (err) {\n        logger_1.logger.debug(err.message);\n        throw new error_1.FirebaseError(`Failed to create iOS app for project ${projectId}. See firebase-debug.log for more info.`, { exit: 2, original: err });\n    }\n}\nexports.createIosApp = createIosApp;\nasync function createAndroidApp(projectId, options) {\n    try {\n        const response = await api.request(\"POST\", `/v1beta1/projects/${projectId}/androidApps`, {\n            auth: true,\n            origin: api.firebaseApiOrigin,\n            timeout: CREATE_APP_API_REQUEST_TIMEOUT_MILLIS,\n            data: options,\n        });\n        const appData = await operation_poller_1.pollOperation({\n            pollerName: \"Create Android app Poller\",\n            apiOrigin: api.firebaseApiOrigin,\n            apiVersion: \"v1beta1\",\n            operationResourceName: response.body.name,\n        });\n        return appData;\n    }\n    catch (err) {\n        logger_1.logger.debug(err.message);\n        throw new error_1.FirebaseError(`Failed to create Android app for project ${projectId}. See firebase-debug.log for more info.`, {\n            exit: 2,\n            original: err,\n        });\n    }\n}\nexports.createAndroidApp = createAndroidApp;\nasync function createWebApp(projectId, options) {\n    try {\n        const response = await api.request(\"POST\", `/v1beta1/projects/${projectId}/webApps`, {\n            auth: true,\n            origin: api.firebaseApiOrigin,\n            timeout: CREATE_APP_API_REQUEST_TIMEOUT_MILLIS,\n            data: options,\n        });\n        const appData = await operation_poller_1.pollOperation({\n            pollerName: \"Create Web app Poller\",\n            apiOrigin: api.firebaseApiOrigin,\n            apiVersion: \"v1beta1\",\n            operationResourceName: response.body.name,\n        });\n        return appData;\n    }\n    catch (err) {\n        logger_1.logger.debug(err.message);\n        throw new error_1.FirebaseError(`Failed to create Web app for project ${projectId}. See firebase-debug.log for more info.`, { exit: 2, original: err });\n    }\n}\nexports.createWebApp = createWebApp;\nfunction getListAppsResourceString(projectId, platform) {\n    let resourceSuffix;\n    switch (platform) {\n        case AppPlatform.IOS:\n            resourceSuffix = \"/iosApps\";\n            break;\n        case AppPlatform.ANDROID:\n            resourceSuffix = \"/androidApps\";\n            break;\n        case AppPlatform.WEB:\n            resourceSuffix = \"/webApps\";\n            break;\n        case AppPlatform.ANY:\n            resourceSuffix = \":searchApps\";\n            break;\n        default:\n            throw new error_1.FirebaseError(\"Unexpected platform. Only support iOS, Android and Web apps\");\n    }\n    return `/v1beta1/projects/${projectId}${resourceSuffix}`;\n}\nasync function listFirebaseApps(projectId, platform, pageSize = APP_LIST_PAGE_SIZE) {\n    const apps = [];\n    try {\n        let nextPageToken = \"\";\n        do {\n            const pageTokenQueryString = nextPageToken ? `&pageToken=${nextPageToken}` : \"\";\n            const response = await api.request(\"GET\", getListAppsResourceString(projectId, platform) +\n                `?pageSize=${pageSize}${pageTokenQueryString}`, {\n                auth: true,\n                origin: api.firebaseApiOrigin,\n                timeout: TIMEOUT_MILLIS,\n            });\n            if (response.body.apps) {\n                const appsOnPage = response.body.apps.map((app) => (app.platform ? app : Object.assign(Object.assign({}, app), { platform })));\n                apps.push(...appsOnPage);\n            }\n            nextPageToken = response.body.nextPageToken;\n        } while (nextPageToken);\n        return apps;\n    }\n    catch (err) {\n        logger_1.logger.debug(err.message);\n        throw new error_1.FirebaseError(`Failed to list Firebase ${platform === AppPlatform.ANY ? \"\" : platform + \" \"}` +\n            \"apps. See firebase-debug.log for more info.\", {\n            exit: 2,\n            original: err,\n        });\n    }\n}\nexports.listFirebaseApps = listFirebaseApps;\nfunction getAppConfigResourceString(appId, platform) {\n    let platformResource;\n    switch (platform) {\n        case AppPlatform.IOS:\n            platformResource = \"iosApps\";\n            break;\n        case AppPlatform.ANDROID:\n            platformResource = \"androidApps\";\n            break;\n        case AppPlatform.WEB:\n            platformResource = \"webApps\";\n            break;\n        default:\n            throw new error_1.FirebaseError(\"Unexpected app platform\");\n    }\n    return `/v1beta1/projects/-/${platformResource}/${appId}/config`;\n}\nfunction parseConfigFromResponse(responseBody, platform) {\n    if (platform === AppPlatform.WEB) {\n        const JS_TEMPLATE = fs.readFileSync(__dirname + \"/../../templates/setup/web.js\", \"utf8\");\n        return {\n            fileName: WEB_CONFIG_FILE_NAME,\n            fileContents: JS_TEMPLATE.replace(\"{/*--CONFIG--*/}\", JSON.stringify(responseBody, null, 2)),\n        };\n    }\n    else if (platform === AppPlatform.ANDROID || platform === AppPlatform.IOS) {\n        return {\n            fileName: responseBody.configFilename,\n            fileContents: Buffer.from(responseBody.configFileContents, \"base64\").toString(\"utf8\"),\n        };\n    }\n    throw new error_1.FirebaseError(\"Unexpected app platform\");\n}\nfunction getAppConfigFile(config, platform) {\n    return parseConfigFromResponse(config, platform);\n}\nexports.getAppConfigFile = getAppConfigFile;\nasync function getAppConfig(appId, platform) {\n    let response;\n    try {\n        response = await api.request(\"GET\", getAppConfigResourceString(appId, platform), {\n            auth: true,\n            origin: api.firebaseApiOrigin,\n            timeout: TIMEOUT_MILLIS,\n        });\n    }\n    catch (err) {\n        logger_1.logger.debug(err.message);\n        throw new error_1.FirebaseError(`Failed to get ${platform} app configuration. See firebase-debug.log for more info.`, {\n            exit: 2,\n            original: err,\n        });\n    }\n    return response.body;\n}\nexports.getAppConfig = getAppConfig;\nasync function listAppAndroidSha(projectId, appId) {\n    const shaCertificates = [];\n    try {\n        const response = await api.request(\"GET\", `/v1beta1/projects/${projectId}/androidApps/${appId}/sha`, {\n            auth: true,\n            origin: api.firebaseApiOrigin,\n        });\n        if (response.body.certificates) {\n            shaCertificates.push(...response.body.certificates);\n        }\n        return shaCertificates;\n    }\n    catch (err) {\n        logger_1.logger.debug(err.message);\n        throw new error_1.FirebaseError(`Failed to list SHA certificate hashes for Android app ${appId}.` +\n            \" See firebase-debug.log for more info.\", {\n            exit: 2,\n            original: err,\n        });\n    }\n}\nexports.listAppAndroidSha = listAppAndroidSha;\nasync function createAppAndroidSha(projectId, appId, options) {\n    try {\n        const response = await api.request(\"POST\", `/v1beta1/projects/${projectId}/androidApps/${appId}/sha`, {\n            auth: true,\n            origin: api.firebaseApiOrigin,\n            timeout: CREATE_APP_API_REQUEST_TIMEOUT_MILLIS,\n            data: options,\n        });\n        const shaCertificate = response.body;\n        return shaCertificate;\n    }\n    catch (err) {\n        logger_1.logger.debug(err.message);\n        throw new error_1.FirebaseError(`Failed to create SHA certificate hash for Android app ${appId}. See firebase-debug.log for more info.`, {\n            exit: 2,\n            original: err,\n        });\n    }\n}\nexports.createAppAndroidSha = createAppAndroidSha;\nasync function deleteAppAndroidSha(projectId, appId, shaId) {\n    try {\n        await api.request(\"DELETE\", `/v1beta1/projects/${projectId}/androidApps/${appId}/sha/${shaId}`, {\n            auth: true,\n            origin: api.firebaseApiOrigin,\n            timeout: CREATE_APP_API_REQUEST_TIMEOUT_MILLIS,\n            data: null,\n        });\n    }\n    catch (err) {\n        logger_1.logger.debug(err.message);\n        throw new error_1.FirebaseError(`Failed to delete SHA certificate hash for Android app ${appId}. See firebase-debug.log for more info.`, {\n            exit: 2,\n            original: err,\n        });\n    }\n}\nexports.deleteAppAndroidSha = deleteAppAndroidSha;\n"]},"metadata":{},"sourceType":"script"}