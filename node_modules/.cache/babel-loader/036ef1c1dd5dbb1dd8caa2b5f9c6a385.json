{"ast":null,"code":"// A reader for when we don't yet know what kind of thing\n// the thing is.\nmodule.exports = ProxyReader;\n\nvar Reader = require('./reader.js');\n\nvar getType = require('./get-type.js');\n\nvar inherits = require('inherits');\n\nvar fs = require('graceful-fs');\n\ninherits(ProxyReader, Reader);\n\nfunction ProxyReader(props) {\n  var self = this;\n\n  if (!(self instanceof ProxyReader)) {\n    throw new Error('ProxyReader must be called as constructor.');\n  }\n\n  self.props = props;\n  self._buffer = [];\n  self.ready = false;\n  Reader.call(self, props);\n}\n\nProxyReader.prototype._stat = function () {\n  var self = this;\n  var props = self.props; // stat the thing to see what the proxy should be.\n\n  var stat = props.follow ? 'stat' : 'lstat';\n  fs[stat](props.path, function (er, current) {\n    var type;\n\n    if (er || !current) {\n      type = 'File';\n    } else {\n      type = getType(current);\n    }\n\n    props[type] = true;\n    props.type = self.type = type;\n    self._old = current;\n\n    self._addProxy(Reader(props, current));\n  });\n};\n\nProxyReader.prototype._addProxy = function (proxy) {\n  var self = this;\n\n  if (self._proxyTarget) {\n    return self.error('proxy already set');\n  }\n\n  self._proxyTarget = proxy;\n  proxy._proxy = self;\n  ['error', 'data', 'end', 'close', 'linkpath', 'entry', 'entryEnd', 'child', 'childEnd', 'warn', 'stat'].forEach(function (ev) {\n    // console.error('~~ proxy event', ev, self.path)\n    proxy.on(ev, self.emit.bind(self, ev));\n  });\n  self.emit('proxy', proxy);\n  proxy.on('ready', function () {\n    // console.error(\"~~ proxy is ready!\", self.path)\n    self.ready = true;\n    self.emit('ready');\n  });\n  var calls = self._buffer;\n  self._buffer.length = 0;\n  calls.forEach(function (c) {\n    proxy[c[0]].apply(proxy, c[1]);\n  });\n};\n\nProxyReader.prototype.pause = function () {\n  return this._proxyTarget ? this._proxyTarget.pause() : false;\n};\n\nProxyReader.prototype.resume = function () {\n  return this._proxyTarget ? this._proxyTarget.resume() : false;\n};","map":{"version":3,"sources":["/home/dev/Documentos/Projects/github-clone/node_modules/fstream/lib/proxy-reader.js"],"names":["module","exports","ProxyReader","Reader","require","getType","inherits","fs","props","self","Error","_buffer","ready","call","prototype","_stat","stat","follow","path","er","current","type","_old","_addProxy","proxy","_proxyTarget","error","_proxy","forEach","ev","on","emit","bind","calls","length","c","apply","pause","resume"],"mappings":"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","sourcesContent":["// A reader for when we don't yet know what kind of thing\n// the thing is.\n\nmodule.exports = ProxyReader\n\nvar Reader = require('./reader.js')\nvar getType = require('./get-type.js')\nvar inherits = require('inherits')\nvar fs = require('graceful-fs')\n\ninherits(ProxyReader, Reader)\n\nfunction ProxyReader (props) {\n  var self = this\n  if (!(self instanceof ProxyReader)) {\n    throw new Error('ProxyReader must be called as constructor.')\n  }\n\n  self.props = props\n  self._buffer = []\n  self.ready = false\n\n  Reader.call(self, props)\n}\n\nProxyReader.prototype._stat = function () {\n  var self = this\n  var props = self.props\n  // stat the thing to see what the proxy should be.\n  var stat = props.follow ? 'stat' : 'lstat'\n\n  fs[stat](props.path, function (er, current) {\n    var type\n    if (er || !current) {\n      type = 'File'\n    } else {\n      type = getType(current)\n    }\n\n    props[type] = true\n    props.type = self.type = type\n\n    self._old = current\n    self._addProxy(Reader(props, current))\n  })\n}\n\nProxyReader.prototype._addProxy = function (proxy) {\n  var self = this\n  if (self._proxyTarget) {\n    return self.error('proxy already set')\n  }\n\n  self._proxyTarget = proxy\n  proxy._proxy = self\n\n  ;[\n    'error',\n    'data',\n    'end',\n    'close',\n    'linkpath',\n    'entry',\n    'entryEnd',\n    'child',\n    'childEnd',\n    'warn',\n    'stat'\n  ].forEach(function (ev) {\n    // console.error('~~ proxy event', ev, self.path)\n    proxy.on(ev, self.emit.bind(self, ev))\n  })\n\n  self.emit('proxy', proxy)\n\n  proxy.on('ready', function () {\n    // console.error(\"~~ proxy is ready!\", self.path)\n    self.ready = true\n    self.emit('ready')\n  })\n\n  var calls = self._buffer\n  self._buffer.length = 0\n  calls.forEach(function (c) {\n    proxy[c[0]].apply(proxy, c[1])\n  })\n}\n\nProxyReader.prototype.pause = function () {\n  return this._proxyTarget ? this._proxyTarget.pause() : false\n}\n\nProxyReader.prototype.resume = function () {\n  return this._proxyTarget ? this._proxyTarget.resume() : false\n}\n"]},"metadata":{},"sourceType":"script"}