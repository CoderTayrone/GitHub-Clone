{"ast":null,"code":"// Basically just a wrapper around an fs.readlink\n//\n// XXX: Enhance this to support the Link type, by keeping\n// a lookup table of {<dev+inode>:<path>}, so that hardlinks\n// can be preserved in tarballs.\nmodule.exports = LinkReader;\n\nvar fs = require('graceful-fs');\n\nvar inherits = require('inherits');\n\nvar Reader = require('./reader.js');\n\ninherits(LinkReader, Reader);\n\nfunction LinkReader(props) {\n  var self = this;\n\n  if (!(self instanceof LinkReader)) {\n    throw new Error('LinkReader must be called as constructor.');\n  }\n\n  if (!(props.type === 'Link' && props.Link || props.type === 'SymbolicLink' && props.SymbolicLink)) {\n    throw new Error('Non-link type ' + props.type);\n  }\n\n  Reader.call(self, props);\n} // When piping a LinkReader into a LinkWriter, we have to\n// already have the linkpath property set, so that has to\n// happen *before* the \"ready\" event, which means we need to\n// override the _stat method.\n\n\nLinkReader.prototype._stat = function (currentStat) {\n  var self = this;\n  fs.readlink(self._path, function (er, linkpath) {\n    if (er) return self.error(er);\n    self.linkpath = self.props.linkpath = linkpath;\n    self.emit('linkpath', linkpath);\n\n    Reader.prototype._stat.call(self, currentStat);\n  });\n};\n\nLinkReader.prototype._read = function () {\n  var self = this;\n  if (self._paused) return; // basically just a no-op, since we got all the info we need\n  // from the _stat method\n\n  if (!self._ended) {\n    self.emit('end');\n    self.emit('close');\n    self._ended = true;\n  }\n};","map":{"version":3,"sources":["/home/dev/Documentos/Projects/github-clone/node_modules/fstream/lib/link-reader.js"],"names":["module","exports","LinkReader","fs","require","inherits","Reader","props","self","Error","type","Link","SymbolicLink","call","prototype","_stat","currentStat","readlink","_path","er","linkpath","error","emit","_read","_paused","_ended"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AAEAA,MAAM,CAACC,OAAP,GAAiBC,UAAjB;;AAEA,IAAIC,EAAE,GAAGC,OAAO,CAAC,aAAD,CAAhB;;AACA,IAAIC,QAAQ,GAAGD,OAAO,CAAC,UAAD,CAAtB;;AACA,IAAIE,MAAM,GAAGF,OAAO,CAAC,aAAD,CAApB;;AAEAC,QAAQ,CAACH,UAAD,EAAaI,MAAb,CAAR;;AAEA,SAASJ,UAAT,CAAqBK,KAArB,EAA4B;AAC1B,MAAIC,IAAI,GAAG,IAAX;;AACA,MAAI,EAAEA,IAAI,YAAYN,UAAlB,CAAJ,EAAmC;AACjC,UAAM,IAAIO,KAAJ,CAAU,2CAAV,CAAN;AACD;;AAED,MAAI,EAAGF,KAAK,CAACG,IAAN,KAAe,MAAf,IAAyBH,KAAK,CAACI,IAAhC,IACHJ,KAAK,CAACG,IAAN,KAAe,cAAf,IAAiCH,KAAK,CAACK,YADtC,CAAJ,EAC0D;AACxD,UAAM,IAAIH,KAAJ,CAAU,mBAAmBF,KAAK,CAACG,IAAnC,CAAN;AACD;;AAEDJ,EAAAA,MAAM,CAACO,IAAP,CAAYL,IAAZ,EAAkBD,KAAlB;AACD,C,CAED;AACA;AACA;AACA;;;AACAL,UAAU,CAACY,SAAX,CAAqBC,KAArB,GAA6B,UAAUC,WAAV,EAAuB;AAClD,MAAIR,IAAI,GAAG,IAAX;AACAL,EAAAA,EAAE,CAACc,QAAH,CAAYT,IAAI,CAACU,KAAjB,EAAwB,UAAUC,EAAV,EAAcC,QAAd,EAAwB;AAC9C,QAAID,EAAJ,EAAQ,OAAOX,IAAI,CAACa,KAAL,CAAWF,EAAX,CAAP;AACRX,IAAAA,IAAI,CAACY,QAAL,GAAgBZ,IAAI,CAACD,KAAL,CAAWa,QAAX,GAAsBA,QAAtC;AACAZ,IAAAA,IAAI,CAACc,IAAL,CAAU,UAAV,EAAsBF,QAAtB;;AACAd,IAAAA,MAAM,CAACQ,SAAP,CAAiBC,KAAjB,CAAuBF,IAAvB,CAA4BL,IAA5B,EAAkCQ,WAAlC;AACD,GALD;AAMD,CARD;;AAUAd,UAAU,CAACY,SAAX,CAAqBS,KAArB,GAA6B,YAAY;AACvC,MAAIf,IAAI,GAAG,IAAX;AACA,MAAIA,IAAI,CAACgB,OAAT,EAAkB,OAFqB,CAGvC;AACA;;AACA,MAAI,CAAChB,IAAI,CAACiB,MAAV,EAAkB;AAChBjB,IAAAA,IAAI,CAACc,IAAL,CAAU,KAAV;AACAd,IAAAA,IAAI,CAACc,IAAL,CAAU,OAAV;AACAd,IAAAA,IAAI,CAACiB,MAAL,GAAc,IAAd;AACD;AACF,CAVD","sourcesContent":["// Basically just a wrapper around an fs.readlink\n//\n// XXX: Enhance this to support the Link type, by keeping\n// a lookup table of {<dev+inode>:<path>}, so that hardlinks\n// can be preserved in tarballs.\n\nmodule.exports = LinkReader\n\nvar fs = require('graceful-fs')\nvar inherits = require('inherits')\nvar Reader = require('./reader.js')\n\ninherits(LinkReader, Reader)\n\nfunction LinkReader (props) {\n  var self = this\n  if (!(self instanceof LinkReader)) {\n    throw new Error('LinkReader must be called as constructor.')\n  }\n\n  if (!((props.type === 'Link' && props.Link) ||\n    (props.type === 'SymbolicLink' && props.SymbolicLink))) {\n    throw new Error('Non-link type ' + props.type)\n  }\n\n  Reader.call(self, props)\n}\n\n// When piping a LinkReader into a LinkWriter, we have to\n// already have the linkpath property set, so that has to\n// happen *before* the \"ready\" event, which means we need to\n// override the _stat method.\nLinkReader.prototype._stat = function (currentStat) {\n  var self = this\n  fs.readlink(self._path, function (er, linkpath) {\n    if (er) return self.error(er)\n    self.linkpath = self.props.linkpath = linkpath\n    self.emit('linkpath', linkpath)\n    Reader.prototype._stat.call(self, currentStat)\n  })\n}\n\nLinkReader.prototype._read = function () {\n  var self = this\n  if (self._paused) return\n  // basically just a no-op, since we got all the info we need\n  // from the _stat method\n  if (!self._ended) {\n    self.emit('end')\n    self.emit('close')\n    self._ended = true\n  }\n}\n"]},"metadata":{},"sourceType":"script"}