{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.monthlyMinInstanceCost = exports.canCalculateMinInstanceCost = exports.V2_FREE_TIER = exports.V1_FREE_TIER = exports.V2_RATES = exports.V1_RATES = void 0;\nconst V1_REGION_TO_TIER = {\n  \"us-central1\": 1,\n  \"us-east1\": 1,\n  \"us-east4\": 1,\n  \"europe-west1\": 1,\n  \"europe-west2\": 1,\n  \"asia-east2\": 1,\n  \"asia-northeast1\": 1,\n  \"asia-northeast2\": 1,\n  \"us-west2\": 2,\n  \"us-west3\": 2,\n  \"us-west4\": 2,\n  \"northamerica-northeast1\": 2,\n  \"southamerica-east1\": 2,\n  \"europe-west3\": 2,\n  \"europe-west6\": 2,\n  \"europe-central2\": 2,\n  \"australia-southeast1\": 2,\n  \"asia-south1\": 2,\n  \"asia-southeast2\": 2,\n  \"asia-northeast3\": 2\n};\nconst V2_REGION_TO_TIER = {\n  \"asia-east1\": 1,\n  \"asia-northeast1\": 1,\n  \"asia-northeast2\": 1,\n  \"europe-north1\": 1,\n  \"europe-west1\": 1,\n  \"europe-west4\": 1,\n  \"us-central1\": 1,\n  \"us-east1\": 1,\n  \"us-east4\": 1,\n  \"us-west1\": 1,\n  \"asia-east2\": 2,\n  \"asia-northeast3\": 2,\n  \"asia-southeast1\": 2,\n  \"asia-southeast2\": 2,\n  \"asia-south1\": 2,\n  \"australia-southeast1\": 2,\n  \"europe-central2\": 2,\n  \"europe-west2\": 2,\n  \"europe-west3\": 2,\n  \"europe-west6\": 2,\n  \"northamerica-northeast1\": 2,\n  \"southamerica-east1\": 2,\n  \"us-west2\": 2,\n  \"us-west3\": 2,\n  \"us-west4\": 2\n};\nexports.V1_RATES = {\n  invocations: 4e-7,\n  memoryGb: {\n    1: 0.0000025,\n    2: 0.0000035\n  },\n  cpuGhz: {\n    1: 0.00001,\n    2: 0.000014\n  },\n  idleCpuGhz: {\n    1: 0.000001,\n    2: 0.00000145\n  },\n  egress: 0.12\n};\nexports.V2_RATES = {\n  invocations: 4e-7,\n  memoryGb: {\n    1: 0.0000025,\n    2: 0.0000035\n  },\n  vCpu: {\n    1: 0.000024,\n    2: 0.0000336\n  },\n  idleVCpu: {\n    1: 0.0000025,\n    2: 0.0000035\n  }\n};\nexports.V1_FREE_TIER = {\n  invocations: 2000000,\n  memoryGb: 400000,\n  cpuGhz: 200000,\n  egress: 5\n};\nexports.V2_FREE_TIER = {\n  invocations: 2000000,\n  memoryGb: 360000,\n  vCpu: 180000,\n  egress: 1\n};\nconst MB_TO_GHZ = {\n  128: 0.2,\n  256: 0.4,\n  512: 0.8,\n  1024: 1.4,\n  2048: 2.4,\n  4096: 4.8,\n  8192: 4.8\n};\n\nfunction canCalculateMinInstanceCost(functionSpec) {\n  if (!functionSpec.minInstances) {\n    return true;\n  }\n\n  if (functionSpec.platform == \"gcfv1\") {\n    if (!MB_TO_GHZ[functionSpec.availableMemoryMb || 256]) {\n      return false;\n    }\n\n    if (!V1_REGION_TO_TIER[functionSpec.region]) {\n      return false;\n    }\n\n    return true;\n  }\n\n  if (!V2_REGION_TO_TIER[functionSpec.region]) {\n    return false;\n  }\n\n  return true;\n}\n\nexports.canCalculateMinInstanceCost = canCalculateMinInstanceCost;\nconst SECONDS_PER_MONTH = 30 * 24 * 60 * 60;\n\nfunction monthlyMinInstanceCost(functions) {\n  const usage = {\n    gcfv1: {\n      1: {\n        ram: 0,\n        cpu: 0\n      },\n      2: {\n        ram: 0,\n        cpu: 0\n      }\n    },\n    gcfv2: {\n      1: {\n        ram: 0,\n        cpu: 0\n      },\n      2: {\n        ram: 0,\n        cpu: 0\n      }\n    }\n  };\n\n  for (const func of functions) {\n    if (!func.minInstances) {\n      continue;\n    }\n\n    const ramMb = func.availableMemoryMb || 256;\n    const ramGb = ramMb / 1024;\n\n    if (func.platform === \"gcfv1\") {\n      const cpu = MB_TO_GHZ[ramMb];\n      const tier = V1_REGION_TO_TIER[func.region];\n      usage[\"gcfv1\"][tier].ram = usage[\"gcfv1\"][tier].ram + ramGb * SECONDS_PER_MONTH * func.minInstances;\n      usage[\"gcfv1\"][tier].cpu = usage[\"gcfv1\"][tier].cpu + MB_TO_GHZ[ramMb] * SECONDS_PER_MONTH * func.minInstances;\n    } else {\n      const cpu = 1;\n      const tier = V2_REGION_TO_TIER[func.region];\n      usage[\"gcfv2\"][tier].ram = usage[\"gcfv2\"][tier].ram + ramGb * SECONDS_PER_MONTH * func.minInstances;\n      usage[\"gcfv2\"][tier].cpu = usage[\"gcfv2\"][tier].cpu + cpu * SECONDS_PER_MONTH * func.minInstances;\n    }\n  }\n\n  let v1MemoryBill = usage[\"gcfv1\"][1].ram * exports.V1_RATES.memoryGb[1] + usage[\"gcfv1\"][2].ram * exports.V1_RATES.memoryGb[2];\n  v1MemoryBill -= exports.V1_FREE_TIER.memoryGb * exports.V1_RATES.memoryGb[1];\n  v1MemoryBill = Math.max(v1MemoryBill, 0);\n  let v1CpuBill = usage[\"gcfv1\"][1].cpu * exports.V1_RATES.idleCpuGhz[1] + usage[\"gcfv1\"][2].cpu * exports.V1_RATES.idleCpuGhz[2];\n  v1CpuBill -= exports.V1_FREE_TIER.cpuGhz * exports.V1_RATES.cpuGhz[1];\n  v1CpuBill = Math.max(v1CpuBill, 0);\n  let v2MemoryBill = usage[\"gcfv2\"][1].ram * exports.V2_RATES.memoryGb[1] + usage[\"gcfv2\"][2].ram * exports.V2_RATES.memoryGb[2];\n  v2MemoryBill -= exports.V2_FREE_TIER.memoryGb * exports.V2_RATES.memoryGb[1];\n  v2MemoryBill = Math.max(v2MemoryBill, 0);\n  let v2CpuBill = usage[\"gcfv2\"][1].cpu * exports.V2_RATES.idleVCpu[1] + usage[\"gcfv2\"][2].cpu * exports.V2_RATES.idleVCpu[2];\n  v2CpuBill -= exports.V2_FREE_TIER.vCpu * exports.V2_RATES.vCpu[1];\n  v2CpuBill = Math.max(v2CpuBill, 0);\n  return v1MemoryBill + v1CpuBill + v2MemoryBill + v2CpuBill;\n}\n\nexports.monthlyMinInstanceCost = monthlyMinInstanceCost;","map":{"version":3,"sources":["/home/dev/Documentos/Projects/github-clone/node_modules/firebase-tools/lib/deploy/functions/pricing.js"],"names":["Object","defineProperty","exports","value","monthlyMinInstanceCost","canCalculateMinInstanceCost","V2_FREE_TIER","V1_FREE_TIER","V2_RATES","V1_RATES","V1_REGION_TO_TIER","V2_REGION_TO_TIER","invocations","memoryGb","cpuGhz","idleCpuGhz","egress","vCpu","idleVCpu","MB_TO_GHZ","functionSpec","minInstances","platform","availableMemoryMb","region","SECONDS_PER_MONTH","functions","usage","gcfv1","ram","cpu","gcfv2","func","ramMb","ramGb","tier","v1MemoryBill","Math","max","v1CpuBill","v2MemoryBill","v2CpuBill"],"mappings":"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","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.monthlyMinInstanceCost = exports.canCalculateMinInstanceCost = exports.V2_FREE_TIER = exports.V1_FREE_TIER = exports.V2_RATES = exports.V1_RATES = void 0;\nconst V1_REGION_TO_TIER = {\n    \"us-central1\": 1,\n    \"us-east1\": 1,\n    \"us-east4\": 1,\n    \"europe-west1\": 1,\n    \"europe-west2\": 1,\n    \"asia-east2\": 1,\n    \"asia-northeast1\": 1,\n    \"asia-northeast2\": 1,\n    \"us-west2\": 2,\n    \"us-west3\": 2,\n    \"us-west4\": 2,\n    \"northamerica-northeast1\": 2,\n    \"southamerica-east1\": 2,\n    \"europe-west3\": 2,\n    \"europe-west6\": 2,\n    \"europe-central2\": 2,\n    \"australia-southeast1\": 2,\n    \"asia-south1\": 2,\n    \"asia-southeast2\": 2,\n    \"asia-northeast3\": 2,\n};\nconst V2_REGION_TO_TIER = {\n    \"asia-east1\": 1,\n    \"asia-northeast1\": 1,\n    \"asia-northeast2\": 1,\n    \"europe-north1\": 1,\n    \"europe-west1\": 1,\n    \"europe-west4\": 1,\n    \"us-central1\": 1,\n    \"us-east1\": 1,\n    \"us-east4\": 1,\n    \"us-west1\": 1,\n    \"asia-east2\": 2,\n    \"asia-northeast3\": 2,\n    \"asia-southeast1\": 2,\n    \"asia-southeast2\": 2,\n    \"asia-south1\": 2,\n    \"australia-southeast1\": 2,\n    \"europe-central2\": 2,\n    \"europe-west2\": 2,\n    \"europe-west3\": 2,\n    \"europe-west6\": 2,\n    \"northamerica-northeast1\": 2,\n    \"southamerica-east1\": 2,\n    \"us-west2\": 2,\n    \"us-west3\": 2,\n    \"us-west4\": 2,\n};\nexports.V1_RATES = {\n    invocations: 4e-7,\n    memoryGb: {\n        1: 0.0000025,\n        2: 0.0000035,\n    },\n    cpuGhz: {\n        1: 0.00001,\n        2: 0.000014,\n    },\n    idleCpuGhz: {\n        1: 0.000001,\n        2: 0.00000145,\n    },\n    egress: 0.12,\n};\nexports.V2_RATES = {\n    invocations: 4e-7,\n    memoryGb: {\n        1: 0.0000025,\n        2: 0.0000035,\n    },\n    vCpu: {\n        1: 0.000024,\n        2: 0.0000336,\n    },\n    idleVCpu: {\n        1: 0.0000025,\n        2: 0.0000035,\n    },\n};\nexports.V1_FREE_TIER = {\n    invocations: 2000000,\n    memoryGb: 400000,\n    cpuGhz: 200000,\n    egress: 5,\n};\nexports.V2_FREE_TIER = {\n    invocations: 2000000,\n    memoryGb: 360000,\n    vCpu: 180000,\n    egress: 1,\n};\nconst MB_TO_GHZ = {\n    128: 0.2,\n    256: 0.4,\n    512: 0.8,\n    1024: 1.4,\n    2048: 2.4,\n    4096: 4.8,\n    8192: 4.8,\n};\nfunction canCalculateMinInstanceCost(functionSpec) {\n    if (!functionSpec.minInstances) {\n        return true;\n    }\n    if (functionSpec.platform == \"gcfv1\") {\n        if (!MB_TO_GHZ[functionSpec.availableMemoryMb || 256]) {\n            return false;\n        }\n        if (!V1_REGION_TO_TIER[functionSpec.region]) {\n            return false;\n        }\n        return true;\n    }\n    if (!V2_REGION_TO_TIER[functionSpec.region]) {\n        return false;\n    }\n    return true;\n}\nexports.canCalculateMinInstanceCost = canCalculateMinInstanceCost;\nconst SECONDS_PER_MONTH = 30 * 24 * 60 * 60;\nfunction monthlyMinInstanceCost(functions) {\n    const usage = {\n        gcfv1: { 1: { ram: 0, cpu: 0 }, 2: { ram: 0, cpu: 0 } },\n        gcfv2: { 1: { ram: 0, cpu: 0 }, 2: { ram: 0, cpu: 0 } },\n    };\n    for (const func of functions) {\n        if (!func.minInstances) {\n            continue;\n        }\n        const ramMb = func.availableMemoryMb || 256;\n        const ramGb = ramMb / 1024;\n        if (func.platform === \"gcfv1\") {\n            const cpu = MB_TO_GHZ[ramMb];\n            const tier = V1_REGION_TO_TIER[func.region];\n            usage[\"gcfv1\"][tier].ram =\n                usage[\"gcfv1\"][tier].ram + ramGb * SECONDS_PER_MONTH * func.minInstances;\n            usage[\"gcfv1\"][tier].cpu =\n                usage[\"gcfv1\"][tier].cpu + MB_TO_GHZ[ramMb] * SECONDS_PER_MONTH * func.minInstances;\n        }\n        else {\n            const cpu = 1;\n            const tier = V2_REGION_TO_TIER[func.region];\n            usage[\"gcfv2\"][tier].ram =\n                usage[\"gcfv2\"][tier].ram + ramGb * SECONDS_PER_MONTH * func.minInstances;\n            usage[\"gcfv2\"][tier].cpu =\n                usage[\"gcfv2\"][tier].cpu + cpu * SECONDS_PER_MONTH * func.minInstances;\n        }\n    }\n    let v1MemoryBill = usage[\"gcfv1\"][1].ram * exports.V1_RATES.memoryGb[1] + usage[\"gcfv1\"][2].ram * exports.V1_RATES.memoryGb[2];\n    v1MemoryBill -= exports.V1_FREE_TIER.memoryGb * exports.V1_RATES.memoryGb[1];\n    v1MemoryBill = Math.max(v1MemoryBill, 0);\n    let v1CpuBill = usage[\"gcfv1\"][1].cpu * exports.V1_RATES.idleCpuGhz[1] + usage[\"gcfv1\"][2].cpu * exports.V1_RATES.idleCpuGhz[2];\n    v1CpuBill -= exports.V1_FREE_TIER.cpuGhz * exports.V1_RATES.cpuGhz[1];\n    v1CpuBill = Math.max(v1CpuBill, 0);\n    let v2MemoryBill = usage[\"gcfv2\"][1].ram * exports.V2_RATES.memoryGb[1] + usage[\"gcfv2\"][2].ram * exports.V2_RATES.memoryGb[2];\n    v2MemoryBill -= exports.V2_FREE_TIER.memoryGb * exports.V2_RATES.memoryGb[1];\n    v2MemoryBill = Math.max(v2MemoryBill, 0);\n    let v2CpuBill = usage[\"gcfv2\"][1].cpu * exports.V2_RATES.idleVCpu[1] + usage[\"gcfv2\"][2].cpu * exports.V2_RATES.idleVCpu[2];\n    v2CpuBill -= exports.V2_FREE_TIER.vCpu * exports.V2_RATES.vCpu[1];\n    v2CpuBill = Math.max(v2CpuBill, 0);\n    return v1MemoryBill + v1CpuBill + v2MemoryBill + v2CpuBill;\n}\nexports.monthlyMinInstanceCost = monthlyMinInstanceCost;\n"]},"metadata":{},"sourceType":"script"}