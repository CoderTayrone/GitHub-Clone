{"ast":null,"code":"/**\n * Copyright 2015 Google Inc. All Rights Reserved.\n * Use of this source code is governed by a BSD-style\n * license that can be found in the LICENSE file or at\n * https://github.com/firebase/superstatic/blob/master/LICENSE\n */\nconst fs = require(\"fs\");\n\nconst template = fs.readFileSync(__dirname + \"/../assets/env.js.template\").toString();\n\nconst mime = require(\"mime-types\");\n\nconst _ = require(\"lodash\");\n\nmodule.exports = function (spec) {\n  return function (req, res, next) {\n    const config = _.get(req, \"superstatic.env\");\n\n    let env;\n\n    if (spec.env || config) {\n      env = _.assign({}, config, spec.env);\n    } else {\n      return next();\n    }\n\n    if (req.url === \"/__/env.json\") {\n      res.superstatic.handleData({\n        data: JSON.stringify(env, null, 2),\n        contentType: mime.contentType(\"json\")\n      });\n      return undefined;\n    } else if (req.url === \"/__/env.js\") {\n      const payload = template.replace(\"{{ENV}}\", JSON.stringify(env));\n      res.superstatic.handleData({\n        data: payload,\n        contentType: mime.contentType(\"js\")\n      });\n      return undefined;\n    }\n\n    return next();\n  };\n};","map":{"version":3,"sources":["/home/dev/Documentos/Projects/github-clone/node_modules/superstatic/lib/middleware/env.js"],"names":["fs","require","template","readFileSync","__dirname","toString","mime","_","module","exports","spec","req","res","next","config","get","env","assign","url","superstatic","handleData","data","JSON","stringify","contentType","undefined","payload","replace"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AAEA,MAAMA,EAAE,GAAGC,OAAO,CAAC,IAAD,CAAlB;;AACA,MAAMC,QAAQ,GAAGF,EAAE,CAChBG,YADc,CACDC,SAAS,GAAG,4BADX,EAEdC,QAFc,EAAjB;;AAGA,MAAMC,IAAI,GAAGL,OAAO,CAAC,YAAD,CAApB;;AACA,MAAMM,CAAC,GAAGN,OAAO,CAAC,QAAD,CAAjB;;AAEAO,MAAM,CAACC,OAAP,GAAiB,UAASC,IAAT,EAAe;AAC9B,SAAO,UAASC,GAAT,EAAcC,GAAd,EAAmBC,IAAnB,EAAyB;AAC9B,UAAMC,MAAM,GAAGP,CAAC,CAACQ,GAAF,CAAMJ,GAAN,EAAW,iBAAX,CAAf;;AACA,QAAIK,GAAJ;;AACA,QAAIN,IAAI,CAACM,GAAL,IAAYF,MAAhB,EAAwB;AACtBE,MAAAA,GAAG,GAAGT,CAAC,CAACU,MAAF,CAAS,EAAT,EAAaH,MAAb,EAAqBJ,IAAI,CAACM,GAA1B,CAAN;AACD,KAFD,MAEO;AACL,aAAOH,IAAI,EAAX;AACD;;AAED,QAAIF,GAAG,CAACO,GAAJ,KAAY,cAAhB,EAAgC;AAC9BN,MAAAA,GAAG,CAACO,WAAJ,CAAgBC,UAAhB,CAA2B;AACzBC,QAAAA,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAeP,GAAf,EAAoB,IAApB,EAA0B,CAA1B,CADmB;AAEzBQ,QAAAA,WAAW,EAAElB,IAAI,CAACkB,WAAL,CAAiB,MAAjB;AAFY,OAA3B;AAIA,aAAOC,SAAP;AACD,KAND,MAMO,IAAId,GAAG,CAACO,GAAJ,KAAY,YAAhB,EAA8B;AACnC,YAAMQ,OAAO,GAAGxB,QAAQ,CAACyB,OAAT,CAAiB,SAAjB,EAA4BL,IAAI,CAACC,SAAL,CAAeP,GAAf,CAA5B,CAAhB;AACAJ,MAAAA,GAAG,CAACO,WAAJ,CAAgBC,UAAhB,CAA2B;AACzBC,QAAAA,IAAI,EAAEK,OADmB;AAEzBF,QAAAA,WAAW,EAAElB,IAAI,CAACkB,WAAL,CAAiB,IAAjB;AAFY,OAA3B;AAIA,aAAOC,SAAP;AACD;;AAED,WAAOZ,IAAI,EAAX;AACD,GAzBD;AA0BD,CA3BD","sourcesContent":["/**\n * Copyright 2015 Google Inc. All Rights Reserved.\n * Use of this source code is governed by a BSD-style\n * license that can be found in the LICENSE file or at\n * https://github.com/firebase/superstatic/blob/master/LICENSE\n */\n\nconst fs = require(\"fs\");\nconst template = fs\n  .readFileSync(__dirname + \"/../assets/env.js.template\")\n  .toString();\nconst mime = require(\"mime-types\");\nconst _ = require(\"lodash\");\n\nmodule.exports = function(spec) {\n  return function(req, res, next) {\n    const config = _.get(req, \"superstatic.env\");\n    let env;\n    if (spec.env || config) {\n      env = _.assign({}, config, spec.env);\n    } else {\n      return next();\n    }\n\n    if (req.url === \"/__/env.json\") {\n      res.superstatic.handleData({\n        data: JSON.stringify(env, null, 2),\n        contentType: mime.contentType(\"json\")\n      });\n      return undefined;\n    } else if (req.url === \"/__/env.js\") {\n      const payload = template.replace(\"{{ENV}}\", JSON.stringify(env));\n      res.superstatic.handleData({\n        data: payload,\n        contentType: mime.contentType(\"js\")\n      });\n      return undefined;\n    }\n\n    return next();\n  };\n};\n"]},"metadata":{},"sourceType":"script"}